<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 10 (filtered)">
<title>Siege</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman";}
h1
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:Arial;
	font-weight:bold;}
h2
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:Verdana;
	font-variant:small-caps;
	font-weight:normal;}
h3
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Arial;
	font-weight:normal;}
h4
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Arial;
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0mm;
	margin-right:0mm;
	margin-bottom:0mm;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0mm;
	margin-bottom:3.0pt;
	margin-left:0mm;
	text-align:center;
	font-size:16.0pt;
	font-family:Arial;
	font-weight:bold;}
p
	{margin-right:0mm;
	margin-left:0mm;
	font-size:12.0pt;
	font-family:"Times New Roman";}
address
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:black;
	font-style:italic;}
pre
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:10.0pt;
	font-family:"Arial Unicode MS";}
p.ProblemExampleCaption, li.ProblemExampleCaption, div.ProblemExampleCaption
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:12.0pt;
	font-family:"Courier New";
	font-weight:bold;}
p.ProblemExample, li.ProblemExample, div.ProblemExample
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Courier New";}
p.Example, li.Example, div.Example
	{margin-top:2.0pt;
	margin-right:0mm;
	margin-bottom:2.0pt;
	margin-left:0mm;
	text-align:justify;
	font-size:10.0pt;
	font-family:"Courier New";}
p.ExampleHeader, li.ExampleHeader, div.ExampleHeader
	{margin-top:6.0pt;
	margin-right:0mm;
	margin-bottom:6.0pt;
	margin-left:0mm;
	text-align:justify;
	font-size:11.0pt;
	font-family:Arial;
	font-weight:bold;
	font-style:italic;}
p.ExampleTableHeader, li.ExampleTableHeader, div.ExampleTableHeader
	{margin-top:2.0pt;
	margin-right:0mm;
	margin-bottom:2.0pt;
	margin-left:0mm;
	text-align:center;
	font-size:10.0pt;
	font-family:"Courier New";
	font-weight:bold;}
p.FigureName, li.FigureName, div.FigureName
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.0pt;
	font-family:Arial;}
p.ProblemStatement, li.ProblemStatement, div.ProblemStatement
	{margin-top:2.0pt;
	margin-right:0mm;
	margin-bottom:0mm;
	margin-left:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.ProblemIOE, li.ProblemIOE, div.ProblemIOE
	{margin-top:6.0pt;
	margin-right:0mm;
	margin-bottom:3.0pt;
	margin-left:0mm;
	text-align:justify;
	font-size:12.0pt;
	font-family:Arial;
	font-weight:bold;
	font-style:italic;}
span.ProblemFormula
	{font-style:italic;}
p.Credits, li.Credits, div.Credits
	{margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	background:white;
	border:none;
	padding:0mm;
	font-size:12.0pt;
	font-family:Arial;
	font-weight:bold;}
@page Section1
	{size:210.0mm 842.0pt;
	margin:72.0pt 89.85pt 72.0pt 89.85pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 ol
	{margin-bottom:0mm;}
ul
	{margin-bottom:0mm;}
-->
</style>

</head>

<body lang=EN-US>

<div class=Section1>

<div style='border:solid windowtext 1.0pt;border-bottom:none;padding:1.0pt 4.0pt 0mm 4.0pt;
background:silver'>

<h1 style='background:silver;border:none;padding:0mm'><a name="_Toc61410117"><span
lang=EN-CA>Problem H</span></a></h1>

<h2 style='background:silver;border:none;padding:0mm'><a name="_Toc61410118"><span
style='font-variant:normal !important;text-transform:uppercase'>Siege</span></a></h2>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The kingdom of Flatland can be represented as a rectangle
M*N, which consists of squares 1*1. Flatland is divided into K provinces (2<span
style='font-family:Symbol'>£</span>K<span style='font-family:Symbol'>£</span>100).
Each province is a connected set of squares i.e. it’s possible to get from one
point of a province to another one. However, it’s allowed to move from square
to square if and only if two squares have the same side (having the same vertex
is not enough). There is no point in Flatland, which has a boundary with more
than three other provinces i.e. four squares, which have the same vertex can’t
belong to four different provinces.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Each province has its own symbol. The capital of Flatland is
situated in the province marked as A (capital Latin A). A province is called a
frontier if it contains frontier squares. The capital of Flatland is not
frontier.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>An evil king from the kingdom of Wreckland wants to conquer
Flatland. In order to do that he wants, he has to conquer the capital of
Flatland. But he knows that his army has not been strong enough to do it at
once, capturing all the provinces. So, the evil king decided to surround the
capital, to weaken the forces of Flatland by long siege, and then conquer the
capital.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In order to surround the capital, he should conquer all
boundary provinces of it. Two provinces are bordering on each other if there
are two squares, which have the same side, one of which belongs to one
province, and the other one belongs to the other one. In order to conquer a
province, the king should do one of these statements: either it is a frontier
province or it is an already conquered province.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In order to save his forces (it’s the most important issue
on a war!), the king of Wreckland wants to conquer as fewer provinces as he
can. Please help him to find out how many provinces he should conquer. The king
realizes that he can’t conquer the capital right now, because his army has not
been strong enough…</p>

<p class=MsoNormal>&nbsp;</p>

<h4>Input</h4>

<p class=MsoNormal>There can be multiple test cases. The first line of each test
case contains M and N (3 <span style='font-family:Symbol'>£</span> M, N <span
style='font-family:Symbol'>£</span> 200). Next M lines contain N symbols each
and give the map of Flatland. The character in i+1-th line in j-th place,
represent the square in (i,j). All the symbols have ASCII-code higher than
32(blank). The input ends with a case where M=0 and N=0. You must not process
this test case.</p>

<p class=MsoNormal>&nbsp;</p>

<h4>Output</h4>

<p class=MsoNormal>The only one line of the output contains the only one number
– the number of provinces which must be conquered. If it is impossible to
conquer the capital, then print “–1”.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<table class=MsoTableList4 border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=328 valign=top style='width:246.35pt;border:solid black 1.5pt;
  border-right:none;background:gray;padding:0mm 5.4pt 0mm 5.4pt'>
  <p class=MsoNormal><b><span style='color:white'>Sample Input</span></b></p>
  </td>
  <td width=328 valign=top style='width:246.35pt;border:solid black 1.5pt;
  border-left:none;background:gray;padding:0mm 5.4pt 0mm 5.4pt'>
  <p class=MsoNormal><b><span style='color:white'>Sample Output</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=328 valign=top style='width:246.35pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:none;
  padding:0mm 5.4pt 0mm 5.4pt'>
  <p class=MsoNormal>5 6</p>
  <p class=MsoNormal>BBBBBZ</p>
  <p class=MsoNormal>BCCCBZ</p>
  <p class=MsoNormal>BCAbbZ</p>
  <p class=MsoNormal>BDDDbZ</p>
  <p class=MsoNormal>33333Z</p>
  <p class=MsoNormal>3 3</p>
  <p class=MsoNormal>BBB</p>
  <p class=MsoNormal>BAB</p>
  <p class=MsoNormal>BBB</p>
  <p class=MsoNormal>0 0</p>
  </td>
  <td width=328 valign=top style='width:246.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0mm 5.4pt 0mm 5.4pt'>
  <p class=MsoNormal>4</p>
  <p class=MsoNormal>1</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0mm 0mm 0mm;
background:white'>

<p class=Credits>Problem source: Russian National Team Olympiad 2001</p>

<p class=Credits>Problem author: Andrew Stankevich</p>

<p class=Credits>Problem translation: Dmytro Chernysh</p>

<p class=Credits>Problem solution: Andrew Stankevich, Dmytro Chernysh</p>

</div>

</div>

</body>

</html>
