<html>

<head>
<title>Colouring the Map, but not anyhow</title>
</head>

<body>
<div align="center"><center>

<table bgColor="#0060f0">
<tbody align="middle">
  <tr>
    <td><font color="#c0ffff" size="5"><b>&nbsp;Coloring the Map, but Not Anyhow&nbsp; </b></font></td>
  </tr>
</tbody>
</table>
</center></div>

<h2><span lang="EN" style="COLOR: #0070e8; mso-ansi-language: EN">The Problem</span></h2>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><img
src="p11206a.gif" align="right" alt="image001.gif (15145 bytes)" hspace="20"><span lang="EN-GB"
style="mso-ansi-language:
EN-GB">We want to solve the classical problem of coloring map
regions in such a way that no regions that share a common boundary have been colored with
the same color, assuming that a <i>boundary</i> is a frontier between two regions larger
than a single point.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">Let <i>R</i>&nbsp;=&nbsp;{<i>r</i><sub>1</sub>, &#133;, <span
class="SpellE"><i>r<sub>n</sub></i></span>} be the set of different regions which the map
consists of; <i>b</i>&nbsp;:&nbsp;<i>R</i>&nbsp;</span><span
style="mso-char-type:symbol;
mso-symbol-font-family:Symbol">x</span><span lang="EN-GB"
style="mso-ansi-language:EN-GB">&nbsp;<i>R</i>&nbsp;<img src="p11206b.gif"
alt="flecha.gif (862 bytes)">&nbsp;<i>Boolean</i>, a function such
that <i>b</i>(<span class="SpellE"><i>r<sub>i</sub></i></span>,&nbsp;<span class="SpellE"><i>r<sub>j</sub></i></span>)&nbsp;=&nbsp;<i>True</i>
<span class="SpellE">iff</span> <span class="SpellE"><i>r<sub>i</sub></i></span> and <span
class="SpellE"><i>r<sub>j</sub></i></span> share a common boundary, and <i>C</i>&nbsp;=&nbsp;{<i>c</i><sub>1</sub>,
&#133;, <i>c<sub>k</sub></i>} the set of available different colors. A solution for this
problem is a mapping <span class="GramE"><i>S</i>&nbsp;:</span>&nbsp;<i>R</i>&nbsp;<img
src="p11206b.gif" alt="flecha.gif (862 bytes)">&nbsp;<i>C</i>
such that:<o:p></o:p></span></p>

<p class="MsoNormal" align="center" style="margin-bottom:6.0pt;text-align:center"><em>b</em>(<em>r<sub>i</sub>,
r<sub>j</sub></em>) = <em>True <img src="p11206c.gif" 
alt="flecha2.gif (862 bytes)"> S</em>(<em>r<sub>i</sub></em>)<em> &ne; S</em>(<em>r<sub>j</sub></em>),
for all <em>r<sub>i</sub></em>, <em>r<sub>j</sub></em> in <em>R</em></p>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">There exist results that prove that only four different
colors (<i>k</i>&nbsp;=&nbsp;4) are sufficient to color any <i>flat</i> map considering
the above conditions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">The main difference between this classical problem and
ours is that we shall not accept <i>any</i> solution, but the <i>best</i> one. We shall
assume that the different colors <i>c</i><sub>1</sub><span class="GramE">, &#133;,</span> <i>c<sub>k</sub></i>
are natural numbers whose value is proportional to their dominant position in the spectrum
of visible light. For any two different colors <span class="SpellE"><i>c<sub>i</sub></i></span>
and <span class="SpellE"><i>c<sub>j</sub></i></span>, the larger |<span class="SpellE"><i>c<sub>i</sub></i></span>&nbsp;&#150;&nbsp;<span
class="SpellE"><i>c<sub>j</sub></i></span>| is, the more different these colors look to
the eye. We want to obtain the solution that maximizes:<o:p></o:p></span></p>

<p align="center"><img src="p11206d.gif" align="top">&nbsp;for
all <em>r<sub>i</sub></em>, <em>r<sub>j</sub></em> in <em>R</em> such that <em>b</em>(<em>r<sub>i</sub>,
r<sub>j</sub></em>) = <em>True</em>, and <em>i</em> &lt; <em>j</em>.</p>

<h2><font color="#0070e8"><a name="SECTION0001003000000000000000">The Input</a></font></h2>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">The input will consist of a set of cases to be solved.
Each case consists of the following input data:<o:p></o:p></span> 

<ul style="margin-top:0cm" type="disc">
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l0 level1 lfo1;tab-stops:list 36.0pt"><span
    lang="EN-GB" style="mso-ansi-language:
     EN-GB">A line with six natural numbers
    separated with a single blank space: NN, NB, C1, C2, C3, and C4, where:<o:p></o:p></span></li>
  <ul style="margin-top:0cm" type="circle">
    <li class="MsoNormal"
    style="margin-bottom:6.0pt;text-align:justify;mso-list:
      l0 level2 lfo1;tab-stops:list 72.0pt"><span
      lang="EN-GB" style="mso-ansi-language:
      EN-GB">NN is the number of map regions (you
      may assume that for any case NN will be 20 at most),<o:p></o:p></span></li>
    <li class="MsoNormal"
    style="margin-bottom:6.0pt;text-align:justify;mso-list:
      l0 level2 lfo1;tab-stops:list 72.0pt"><span
      lang="EN-GB" style="mso-ansi-language:
      EN-GB">NB is the number of boundaries among
      the NN regions, and<o:p></o:p></span></li>
    <li class="MsoNormal"
    style="margin-bottom:6.0pt;text-align:justify;mso-list:
      l0 level2 lfo1;tab-stops:list 72.0pt"><span
      lang="EN-GB" style="mso-ansi-language:
      EN-GB">C1<span class="GramE">, &#133;,</span>
      C4 are the values of the four available colors.<o:p></o:p></span></li>
  </ul>
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l0 level1 lfo1;tab-stops:list 36.0pt"><span
    lang="EN-GB" style="mso-ansi-language:
     EN-GB">NB lines with two natural numbers
    between 1 and NN each that identify the regions that share one boundary.<o:p></o:p></span></li>
</ul>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">You may assume that the input data correspond to a
feasible flat map, and that no region will be adjacent to (share a boundary with) itself.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">A case starting with a line containing a single zero marks
the end of the input data. This case should not be processed nor output issued for it.<o:p></o:p>&nbsp;</o:p></span></p>
<span lang="EN" style="mso-ansi-language: EN">

<h2><font color="#0070e8">The Output</font></h2>
</span>

<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">For each input case to be solved, the program must issue
an output line with a single number with the value of the best solution, i.e. the maximum
value found for:<o:p></o:p></span></p>

<p align="center"><img src="p11206d.gif" align="top">&nbsp;for
all <em>r<sub>i</sub></em>, <em>r<sub>j</sub></em> in <em>R</em> such that <em>b</em>(<em>r<sub>i</sub>,
r<sub>j</sub></em>) = <em>True</em>, and <em>i</em> &lt; <em>j</em>.</p>

<p class="MsoNormal" style="margin-bottom:6.0pt"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">There should appear no blank spaces in the output line
after of before this value.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:6.0pt"><span lang="EN-GB"
style="mso-ansi-language:EN-GB">You may also assume that results will never exceed a 32
bits signed integer number.<o:p></o:p></span></p>

<h2><font color="#0070e8">Sample Input</font><img src="p11206e.gif"
alt="image007.gif (1059 bytes)" align="right"></h2>

<pre>5 8 1 4 8 20
1 2
1 3
1 4
2 4
2 5
3 5
4 3
4 5
0
</pre>

<h2><font color="#0070e8">Sample Output</font><img src="p11206f.gif"
alt="image008.gif (1344 bytes)" align="right"></h2>

<pre>1974
</pre>
</body>
</html>
