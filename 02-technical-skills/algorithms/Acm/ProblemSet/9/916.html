<HTML>

<head>
<title>Dividing Land</title>
</head>

<BODY bgcolor="white">

<FONT color="#0000FF"><H1>Problem A</H1></FONT>

<FONT color="#0000FF"><H1><CENTER>Dividing Land</CENTER></H1></FONT>

<p><img align =right src="p916.gif" border=1 width=364 height=180>
Once upon a time there existed a king that held the greatest fortune in the
entire world. He had 4 sons and he loved them equally.

<p>The years passed and one day the king was dying. He decided then to
give his kingdom equally to his four sons. Suppose that we represent
the kingdom by set of connected squares. Some locations on a kingdom had
special natural resources like gold, marked as 'G'. Other places whith
no natural resources are marked with X. Here is a map of the kingdom:

<pre>
XX
GG
GXXG
XXXX
</pre>

<p>The king wanted that each son had exactly the same number of squares,
that all squares of the same son would be connected (vertically or
horizontally) and that the shape of each son's terrain would be exactly
the same, except for rotations or reflections.

<p>He then asked all the wise men from the kingdom to find an answer for this
problem and after months thinking they found the following solution (each 
son's terrain is indicated by a different number):

<pre>
11
12
3224
3344
</pre>

But if the terrain was different, could you find a solution? And if the resources
were also different? And if he had a different number of children?

<FONT color="#0000FF"><H2>Problem</H2></FONT>

<p>Your task it find if there exists a way to divide a determined terrain in
<b>N</b> different parcels of terrain, each one exactly with the same shape
(except for rotations and reflections) and the same set of natural resources.

<FONT color="#0000FF"><H2>Input</H2></FONT>

<p>The input starts with a single number <b>T</b> indicating
the number of test cases that follow.

<p>Each test case starts with a line with three integer numbers <b>L</b>, <b>C</b>
and <b>N</b>  (<i>1 &le; L,C &le; 10</i> and <i>1 &le; N &le; 5</i>),
indicating the number of lines and columns that the closest
rectangle that could enclose the terrain has, and also the number <i>N</i> of sons
that the king has.

<p>Then follows <i>L</i> lines giving the map of the terrain where

<li><b>"#"</b> indicates a square that does not belong to the kingdom
<li><b>"."</b> means a square that belongs to the kingdom but has no natural
               resources
<li><b>"A-Z"</b> (a single letter) represents a square that has a natural resource
    of type A-Z. (for example, G means tipe G).

<p>The first sample input corresponds to the original map described earlier.

<FONT color="#0000FF"><H2>Output</H2></FONT>

<p>For each test case output a single line saying only "Yes" if it is possible
to divide the terrain in the specified conditions and "No" otherwise.

<FONT color="#0000FF"><H2>Sample Input</H2></FONT>

<PRE>
3
4 4 4
..##
GG##
G...
...G
4 4 4
..##
GG##
G...
...A
6 4 2
ABAB
CDCD
EFEF
ABAB
CDCD
EFEF
</PRE>

<FONT color="#0000FF"><H2>Sample Output</H2></FONT>

<PRE>
Yes
No
Yes
</PRE>


<BR>
<HR>
<i>
Pedro Ribeiro, 2nd round of CPUP'04<br>
(Concurso de Programação da Universidade do Porto 2004)<br>
(Torneio Inter-Universitário de Programação, 2004, Round 3)
</i>


</BODY>
</HTML>

