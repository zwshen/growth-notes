<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./c_files/filelist.xml">
<link rel=Edit-Time-Data href="./c_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem C - 2-D Nim</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Shahriar Manzoor</o:Author>
  <o:LastAuthor>Shahriar Manzoor</o:LastAuthor>
  <o:Revision>73</o:Revision>
  <o:TotalTime>67</o:TotalTime>
  <o:Created>2004-05-17T15:23:00Z</o:Created>
  <o:LastSaved>2004-08-25T04:11:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>375</o:Words>
  <o:Characters>2139</o:Characters>
  <o:Company>ACM/ICPC</o:Company>
  <o:Lines>17</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2626</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:SimSun;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:TimesNewRoman;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"TimesNewRoman\,Italic";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:SymbolMT;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	mso-font-kerning:0pt;
	font-weight:normal;
	font-style:italic;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:Arial;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:18.0pt;
	mso-bidi-font-size:1.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:TimesNewRoman;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:24.0pt;
	mso-bidi-font-size:1.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:#772222;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1030"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
<meta content="" name=Author>
<meta content="" name=Keywords>
<meta content="" name=Description>
</head>

<body lang=EN-US link="#772222" vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoTitle><span style='font-size:28.0pt;mso-bidi-font-size:1.0pt;
font-family:Arial'>Problem C<o:p></o:p></span></p>

<p class=MsoSubtitle><span class=MsoHyperlink><span style='font-size:20.0pt;
mso-bidi-font-size:1.0pt;font-family:Arial;color:black;text-decoration:none;
text-underline:none'>2-D Nim</span></span><span style='font-size:20.0pt;
mso-bidi-font-size:1.0pt;font-family:Arial;color:black'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:
none'><b><span style='font-family:Arial;color:black'>Input:</span></b><span
style='font-family:Arial;color:black'> standard input<br>
<b>Output:</b> standard output<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b
style='mso-bidi-font-weight:normal'><span style='font-family:Arial;color:black'>Time
Limit: </span></b><span style='font-family:Arial;color:black;mso-bidi-font-weight:
bold'>1</span><span style='font-family:Arial;color:black'> second</span></p>

<p class=MsoNormal style='text-align:justify;mso-layout-grid-align:none;
text-autospace:none'>The <b>2D</b>-Nim board game is played on a grid, with
pieces on the grid points. On each move, a player may remove any positive number
of contiguous pieces in any row or column. The player who removes the last
piece wins. For example, consider the left grid in the following figure.</p>

<img src="p10707.jpg">


<p class=MsoBodyText><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoBodyText>The player on move may remove <b>(A)</b>, <b>(B)</b>, <b>(A,
B)</b>, <b>(A, B, C)</b>, or <b>(B,F)</b>, etc., but may not remove <b>(A, C)</b>,
<b>(D, E)</b>, <b>(H, I)</b> or <b>(B, G)</b>. For purposes of writing <b>2D</b>-Nim-playing
software, a certain programmer wants to be able to tell whether or not a
certain position has ever been analyzed previously. Because of the rules of <b>2D</b>-Nim,
it should be clear that the two boards above are essentially equivalent. That
is, if there is a winning strategy for the left board, the same one must apply
to the right board. The fact that the contiguous groups of pieces appear in
different places and orientations is clearly irrelevant. All that matters is
that the same clusters of pieces (a cluster being a set of contiguous pieces
that can be reached from each other by a sequence of one-square vertical or
horizontal moves) appear in each. For example, the cluster of pieces <b>(A, B,
C, F, G)</b> appears on both boards, but it has been reflected (swapping left
and right), rotated, and moved. Your task is to determine whether two given
board states are equivalent in this sense or not.</p>

<h3><span style='font-size:16.0pt;mso-bidi-font-size:13.5pt;font-family:Arial'>Input<o:p></o:p></span></h3>

<p class=MsoNormal style='text-align:justify;mso-layout-grid-align:none;
text-autospace:none'>The first line of the input file contains a single integer
<b><span style='font-family:"TimesNewRoman\,Italic"'>t </span>(1&lt;</b><b><span
style='font-family:SymbolMT'>=</span></b><b><span style='font-family:"TimesNewRoman\,Italic"'>t&lt;</span></b><b><span
style='font-family:SymbolMT'>=</span>12)</b>, the number of test cases,<span
style="mso-spacerun: yes">  </span>followed by the input data for each test
case. The first line of each test case consists of three integers <b>W</b>, <b>H</b>,
and <b><span style='font-family:"TimesNewRoman\,Italic"'>n</span></b><i><span
style='font-family:"TimesNewRoman\,Italic"'> </span></i><b>(1 &lt;</b><b><span
style='font-family:SymbolMT'>=</span>W, </b><b><span style='font-family:"TimesNewRoman\,Italic"'>H
&lt;</span></b><b><span style='font-family:SymbolMT'>=</span>100)</b>. <b><span
style='font-family:"TimesNewRoman\,Italic"'>W</span></b><i><span
style='font-family:"TimesNewRoman\,Italic"'> </span></i>is the width, and <b><span
style='font-family:"TimesNewRoman\,Italic"'>H</span></b><i><span
style='font-family:"TimesNewRoman\,Italic"'> </span></i>is the height of the grid
in terms of the number of grid points. <b>n</b><b><span style='font-family:
"TimesNewRoman\,Italic"'>(n&lt;=3000)</span></b><i><span style='font-family:
"TimesNewRoman\,Italic"'> </span></i>is the number of pieces on each board. The
second line of each test case contains a sequence of <b><span style='font-family:
"TimesNewRoman\,Italic"'>n</span></b><i><span style='font-family:"TimesNewRoman\,Italic"'>
</span></i>pairs of integers <b><span style='mso-bidi-font-size:6.5pt'>x<sub>i</sub></span>,
</b><b><span style='mso-bidi-font-size:6.5pt'>y</span><sub>i</sub></b>, giving
the coordinates of the pieces on the first board <b>(0 </b><b><span
style='font-family:SymbolMT'>=&lt;</span></b><b><span style='mso-bidi-font-size:
6.5pt'> x<sub>i</sub></span></b><b><i><span style='font-size:6.5pt;font-family:
"TimesNewRoman\,Italic"'> </span></i>&lt; </b><b><i><span style='font-family:
"TimesNewRoman\,Italic"'>W </span></i>and 0 </b><b><span style='font-family:
SymbolMT'>=&lt;</span></b><b><span style='mso-bidi-font-size:6.5pt'> y</span><sub>i</sub>&lt;
H)</b>. The third line of the test case describes the coordinates of the pieces
on the second board in the same format.</p>

<h3><span style='font-size:16.0pt;mso-bidi-font-size:13.5pt;font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></h3>

<h3><span style='font-size:16.0pt;mso-bidi-font-size:13.5pt;font-family:Arial'>Output<o:p></o:p></span></h3>

<p class=MsoNormal style='text-align:justify;mso-layout-grid-align:none;
text-autospace:none'>Your program should produce a single line for each test
case containing a word <b>YES</b> or <b>NO</b> indicating whether the two
boards are equivalent or not.</p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 align=left style='text-align:left'><b><span style='font-size:16.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;font-style:normal'>Sample
Input<span style="mso-spacerun: yes">                                      
</span>Output for Sample Input<o:p></o:p></span></b></h1>

<table border=1 cellspacing=0 cellpadding=0 bgcolor="#cccccc" style='background:
 #CCCCCC;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=367 valign=top style='width:275.4pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'><pre><b>2<o:p></o:p></b></pre><pre><b>8 5 11<o:p></o:p></b></pre><pre><b>0 0 1 0 2 0 5 0 7 0 1 1 2 1 5 1 3 3 5 2 4 4<o:p></o:p></b></pre><pre><b>0 4 0 3 0 2 1 1 1 4 1 3 3 3 5 2 6 2 7 2 7 4<o:p></o:p></b></pre><pre><b>8 5 11<o:p></o:p></b></pre><pre><b>0 0 1 0 2 0 5 0 7 0 1 1 2 1 5 1 3 3 6 1 4 4<o:p></o:p></b></pre><pre><b>0 4 0 3 0 2 1 1 1 4 1 3 3 3 5 2 6 2 7 2 7 4</b><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></b></pre>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  mso-layout-grid-align:none;text-autospace:none'><![if !supportEmptyParas]>&nbsp;<![endif]><b
  style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;font-family:
  "Courier New";mso-fareast-font-family:SimSun;color:black;mso-fareast-language:
  ZH-CN'><o:p></o:p></span></b></p>
  </td>
  <td width=264 valign=top style='width:2.75in;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'><pre><b>YES<o:p></o:p></b></pre><pre><b>NO<o:p></o:p></b></pre>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  mso-layout-grid-align:none;text-autospace:none'><![if !supportEmptyParas]>&nbsp;<![endif]><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  mso-fareast-font-family:SimSun;mso-fareast-language:ZH-CN'><o:p></o:p></span></b></p>
  </td>
 </tr>
</table>


<div class=MsoNormal align=center style='text-align:center'>

<hr size=2 width="100%" align=center>

</div>


<p class=MsoNormal><b><span style='font-family:Arial'>Problem Source: Iranian
Contest<o:p></o:p></span></b></p>

<h2>Special Thanks: Jimmy Mårdell, EPS.<span style='font-weight:normal'> <o:p></o:p></span></h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
