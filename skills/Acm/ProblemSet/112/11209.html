<html>
<head>
<title>Problem B: Be Together Again and Forever</title>
<link rel="stylesheet" href="problem.css">
</head>
<body>

<center>
<h1>Problem B</h1>
<h2>Be Together Again and Forever</h2>
</center>

<p>Jiajia and WinD quarreled. They got angry with each other. 
They went far from each other. They regretted. They missed each 
other so much. They wanna say sorry. They wanna meet in a city as 
soon as possible. They wanna be together again and forever.</p>

<p>Each of their routes should be simple - no city should be reached 
more than once. Their routes should be disjoint - no city should be 
reached by them both, except the last one - their meeting city. They 
don't want anyone to travel more, so the distance covered by them should 
be exactly the same.</p>

<h2>Input</h2>
The input consists of at most 20 test cases. Each case begins with a line 
containing four integers <i>n</i>, <i>m</i>, <i>J</i>, <i>W</i> 
(0 < <i>n</i> < 201, 0 < <i>m</i> < 3<i>n</i>/2, 1 <= <i>J</i>, <i>W</i> <= <i>n</i>), 
the number of cities and bidirectional roads in the city network, and the initial city 
number of Jiajia and WinD. Each of the following <i>m</i> lines describes a road. 
There are three integers in each road description: <i>i</i>, <i>j</i>, <i>d</i>, indicating 
there is a bidirectional road connected <i>i</i> and <i>j</i>, with length <i>d</i> 
(1 <= <i>i</i>,<i>j</i> <= <i>n</i>, 1 <= <i>d</i> <= 10). Each pair of cities can be connected 
by at most one road. It is assumed that every pair of cities can be reached from each other. 
<i>J</i> does not equal to <i>W</i>. The last case is followed by a single zero, which should not be processed.

<h2>Output</h2>
For each test case, print the case number and the distance covered by each person in the first line. 
The next two lines should contain the route plan for Jiajia and WinD, respectively. 
Each route plan begins with an integer <i>c</i>, the number of cities visited. The next <i>c</i> integers 
form the list of cities visited. There is always a solution.

<h2>Sample Input</h2>
<pre>
4 4 1 4
1 2 1
2 3 1
3 4 2
1 3 1
4 5 1 4
1 2 2
1 3 5
2 3 4
2 4 1
3 4 1
0
</pre>

<h2>Output for the Sample Input</h2>
<pre>
Case 1: 2
3 1 2 3
2 4 3

Case 2: 5
2 1 3
3 4 2 3
</pre>

<hr />
<i>Rujia Liu's Present 2: A Big Contest of Brute Force</i><br />
<i>Adapted from Balkan Olympiad in Informatics 1998, with test data enhanced</i><br />

</body>
</html>