<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

<head>
  <title>MIUP'2003: Problem I</title>
</head>

<body bgcolor="white">
<font color="#0000ff">
<h1>Problem I</h1>
<h1 align="center">Live From Mars</h1>
</font>
<p align="justify"> </p>
<p align="justify"><font color="#000000">At the 26th of august 2003,
Mars was never so close to the Earth since 60.000 years. Taking
advantage of this fact, the most powerful shortsighted telescope,
Hubble, made an incredible discovery: there is life in Mars, mutant
life indeed!<br>
<br>
Professor B. Harper, who leads the team that made this discovery, found
traces of a unicellular form of life. This kind of cell possess a new
kind of DNA: a mutant DNA that is able to specialize its inner
structure when exposed to radiations. Remarkably, B. Harper showed how
to produce any desired mutation by an appropriate radiation.<br>
<br>
L. Kravitz, B. Harper's student, focuses its research work on a
classification of these cells based on their capacity to mutate.<br>
<br>
Your work is to provide him a computer program that is able to find if
two mutant DNA sequences of the same length can mutate to a common DNA
sequence. <font color="#0000ff">
<h2>Problem</h2>
</font> </font></p>
<p align="justify"><font color="#000000"> </font>A mutant DNA sequence
is composed by the usual DNA elements, say, for the sake of simplicity, <tt>A</tt>,<tt>B</tt>,<tt>C</tt>,
and <tt>D</tt> and by mutant elements <tt>1</tt>, <tt>2</tt>, <tt>3</tt>,<tt>4</tt>,<tt>5</tt>,
and so on ...<br>
<br>
<em>Only</em> the mutant elements can mutate, and they mutate only <em>once</em>
to A, B, C or D. Then, a mutation is a process that takes a mutant DNA
sequence and transforms some (eventually all) mutant elements to normal
elements.<br>
<br>
For instance, let be <i>DNA</i><sub><font size="2">1</font></sub> the
following mutant DNA sequence <tt>A1CD1A2D3B2C5</tt> and <i>MUT</i> the
following mutation <tt>[(1,<i>A</i>),(2,<i>B</i>),(3,<i>C</i>),(4,<i>A</i>)]</tt>
(which means mutate all occurrences of <tt>1</tt> into <tt>A</tt>, <tt>2</tt>
into <tt>B</tt>, <tt>3</tt> into <tt>C</tt> and <tt>4</tt> into <tt>A</tt>).<i>MUT</i>
transforms <i>DNA</i><sub><font size="2">1</font></sub> into <i>DNA</i><sub><font
 size="2">2</font></sub>: <tt>AACDAABDCBBC5</tt>.  In this case, we
say that <i>DNA</i><sub><font size="2">2</font></sub> is a descendant
of <i>DNA</i><sub><font size="2">1</font></sub>.<br>
<br>
Two mutant DNA sequences of length <i>n</i>, <i>x</i><sub><font
 size="2">1</font></sub>,<i>x</i><sub><font size="2">2</font></sub>,...
,<i>x</i><sub><font size="2"><i>n</i></font></sub> and <i>y</i><sub><font
 size="2">1</font></sub>,<i>y</i><sub><font size="2">2</font></sub>,...
,<i>y</i><sub><font size="2"><i>n</i></font></sub> are equivalent under
mutation if, for  all <i>i</i> such that 1<font face="symbol">&pound;</font> <i>i</i> <font
 face="symbol">&pound;</font> <i>n</i>, <i>x</i><sub><font size="2"><i>i</i></font></sub>
and <i>y</i><sub><font size="2"><i>i</i></font></sub> are both normal 
DNA elements and are equal, or <i>x</i><sub><font size="2"><i>i</i></font></sub>
and <i>y</i><sub><font size="2"><i>i</i></font></sub> are both mutant
DNA  elements (and it is not required in this case that <i>x</i><sub><font
 size="2"><i>i</i></font></sub> and <i>y</i><sub><font size="2"><i>i</i></font></sub>
are equal) <br>
<br>
Let <i>DNA</i><sub><font size="2">1</font></sub> and <i>DNA</i><sub><font
 size="2">2</font></sub> be two mutant DNA sequences of the same length.
The shortest common mutation of <i>DNA</i><sub><font size="2">1</font></sub>
and <i>DNA</i><sub><font size="2">2</font></sub>, say <i>MUT</i>, is
the shortest mutation that transforms <i>DNA</i><sub><font size="2">1</font></sub>
and <i>DNA</i><sub><font size="2">2</font></sub> into descendants which
are equivalent under mutation. <i>MUT</i> is the shortest in the sense
that it implies the transformation of the smallest number of mutant
elements. Note that <i>MUT</i> may not exist.<br>
<br>
So, your work is to provide a program that reads two mutant DNA
sequences and replies </p>
<ul>
  <li> NO, if there is no descendents of these two sequences that  are
equivalent by mutation. In other words, if there is no <em>common</em>
mutations. Otherwise, </li>
  <li>YES and a print of the shortest common mutation, if there exists 
such a mutation. </li>
</ul>
<!--TOC subsection Input-->
<p align="justify"><font color="#000000"><font color="#0000ff">
<h2>Input</h2>
</font> </font></p>
<b>
The input will contain several test cases, each of them as described below.
Consecutive test cases are separated by a single blank line.
</b>
<p>
<p>
 <p align="justify"> The input for the program is structured as follow: </p>
<ul>
  <li> the first line of the input contains the length <i>m</i> (with <i>m</i><font
 face="symbol">&pound;</font> 200) of the considered DNA sequences </li>
  <li>the next <i>m</i> lines contain one mutant DNA element  (<tt>A</tt>,<tt>B</tt>,<tt>C</tt>,<tt>D</tt>
or a  natural number). They code the first mutant DNA sequence. </li>
  <li>the last <i>m</i> lines contain one mutant DNA element  (<tt>A</tt>,<tt>B</tt>,<tt>C</tt>,<tt>D</tt>
or a  natural number). They code the second mutant DNA sequence.</li>
</ul>
<p align="justify"><font color="#000000"><font color="#0000ff">
<h2>Output</h2>
</font> </font></p>
<b>
For each test case, the output must follow the description below.
The outputs of two consecutive cases will be separated by a blank line.
</b>
<p>
<p>
<p align="justify"> The output for the program is structured as follow:
in case of failure (no mutations were found) the program simply display <tt>NO</tt>.
In the other case, a mutation involving <i>n</i> mutant elements was
found and so: </p>
<ul>
  <li> the first line is the string <tt>YES</tt>; </li>
  <li>the <i>n</i> following lines describe the shortest common
  mutation; each line has the form <i>m</i> <i>d</i><br>
	  where <i>m</i> is a mutant element (a natural number)
	  and <i>d</i> the name of  the associated normal <tt>DNA</tt> element 
(<tt>A</tt>,
<tt>B</tt>, <tt>C</tt> or <tt>D</tt>). Note that <i>m</i> and <i>d</i>  are
separated by a single space. The elements of the  mutation are sorted
by the first component (the mutant element).  Thus, the mutation
involving <tt>1</tt> will be displayed before <tt>2</tt>.</li>
</ul>
<p align="justify"><font color="#000000"><font color="#0000ff">
<h2>Sample Input</h2>
</font> </font></p>
<pre>7<br>A<br>1<br>2<br>B<br>1<br>D<br>4<br>1<br>3<br>B<br>2<br>3<br>D<br>4<br><!--TOC subsection Sample Output--><br></pre>
<font color="#000000"><font color="#0000ff">
<h2>Sample Output</h2>
</font> </font>
<pre>YES<br>1 A<br>2 B<br>3 A</pre>

<hr>
<i>
Simão Sousa, MIUP'2003<br>
(Portuguese National ACM Programming Contest)
</i>

</body>

</html>
