<HTML> <HEAD> <TITLE>Problem D: Surveying </TITLE> </HEAD> <BODY
LANG="EN" BGCOLOR=#FFFFFF>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;<A NAME="SECTION0001000000000000000000">Problem D: Surveying</A></FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>

<H2><FONT COLOR=#0070E8><A
NAME="Surveying">Problem</A></FONT></H2> <P>

After the radar station in Skrund (Latvia) has been abolished,
Russian Ministry of Peace decided to build a new radar station in
other neighbouring country.<P>

Before building and projecting it is necessary to provide a
surveying of the site where the radar station will be build. To do
this, first of all one introduces a coordinate grid in the
rectangular region <I>K&times;M</I>, where <I>0&LT;K,M&LT;=100</I>.
Thus every node of the grid (the intersection of a grid lines) has
coordinates <I>(i,j), 1&lt;=i&LT;=K, 1&lt;=j&LT;=M.</I> The result of
surveying is <I>geodetical  site plan,</I> i.e. the table, which
contains the relative heights of all the grid nodes measured with
respect to distinguished node, called <I>base</I>.

All the preliminary works including surveying are carrying out
in the top-secret mode. In particular, one is not allowed to clear
the site. This restricts visibility very much. That is why the
surveying is carrying out in stages. One choose the <I>point of
surveying</I> and measure the heights with
respect to this point for all the visible nodes. Then one passes
to the second point of surveying, and so on. Every time the
heights with respect to the current point of surveying are
measured. After the measuring from all the points of surveying has
been completed, one recalculates the heights with respect to the
base and write it down to the geodetical site plan. <P>

You are expected to write a program, which will read the
measurement results and form a geodetical site plan.


</U></U><H2><FONT COLOR=#0070E8>Input</FONT></H2> <P> The input
will consist of <I>N</I> input blocks separated by a blank line.
The amount <I>N</I> of input blocks will be given in the very
first line and followed by a blank line.<P>

The structure of the each input block will be the following. In
the first line there will be two integers <I>K</I> and <I>M</I>
defining the size of the site. The second line will contain two
integers also separated by a space, <I>i</I> and <I>j</I> - the
coordinates of the base. This two lines will be followed by
measurements from different points of surveying. The measurements
from each surveying point will be placed in one line. It will be a
series of triples of integers separated by a space. Each triple
will have the following form: <I> i j h </I>, where <I> i j </I>
are the coordinates of the node, <I> h </I> - its weight in
millimeters with respect to the current surveying point. There
will be also a space between the triples.  This series is
terminated by &LT;EOLN&GT;. The last line of the input block will be
followed by blank line.<P>

The last line of the last input block will be followed immediately
by &LT;EOF&GT;. <P>

Note that used geodetical equipment does not allow to measure the
heights of absolute value greater than 1 meter. (If the point
locates below the point of surveying, we think that its relative height
is negative.)<P>



<H2><FONT COLOR=#0070E8>Output</FONT></H2> <P>

For every input block there should be appropriate output block.
Please, separate all the output blocks with a blank line and do
not place a blank line after the last output block. <P>

Each output block should contain the geodetical site plan, if it
can be built according to the given measurements, or the proper
error message.<P>

The geodetical site plan should be written in the following way:
<P><PRE>
h<sub>11</sub> h<sub>12</sub> h<sub>13</sub> ... h<sub>1M</sub>
h<sub>21</sub> h<sub>22</sub> h<sub>23</sub> ... h<sub>2M</sub>
.................
h<sub>K1</sub> h<sub>K2</sub> h<sub>K3</sub> ... h<sub>KM</sub>
</PRE>

where <I>h<sub>ij</sub></I> is the relative height of the node <I>(i,j)</I>
with respect to the base, in millimeters.

<H2><FONT COLOR=#0070E8>Errors</FONT></H2> <P>
The program should process two errors. <P>

If there is not enough measurements to build a geodetical site
plan, the output should consist of one string with an
inscription "<tt>the lack of measurements</tt>".<P>

If there are conflicting measurements, i.e. the height of some
node can be determined not uniquely, the output should consist
of one string "<tt>conflicting measurements</tt>".<P>

If there are both conflicting measurements and the lack of
measurement, you should output only "<tt>conflicting measurements</tt>".<P>


<H2><FONT COLOR=#0070E8>Sample Input</FONT></H2> <P> <PRE>
3

2 2
1 2
1 1 10 1 2 10
1 2 20 2 2 30 2 1 30

2 2
1 1
1 1 10 1 2 10

2 2
1 2
1 1 10 1 2 10
1 1 20 1 2 30
</PRE> <P>


<H2><FONT COLOR=#0070E8>Sample
Output</A></FONT></H2> <P> <PRE>
0 0
10 10

the lack of measurements

conflicting measurements
<span
style='mso-bidi-font-size:13.5pt;color:windowtext'>
<hr size=2 width="100%" align=center>
<span style='mso-bidi-font-size:13.5pt;color:windowtext'> </span>
<H4>Alexander Denisjuk, 2000</H4> </PRE> </BODY> </HTML>
