
<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Dragster</TITLE>
<META NAME="description" CONTENT="Dragster">
<META NAME="keywords" CONTENT="htmlatex">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="htmlatex.css">

</HEAD>

<BODY LANG="EN" BGCOLOR=#FFFFFF>

<H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0000ff><TR><TD><B><FONT SIZE=5 COLOR=#FFff00>&nbsp;<A NAME="SECTION0001000000000000000000">
Dragster</A>&nbsp;</FONT></B></TABLE></CENTER>
</H1>
Dragster racing is not very popular in Brazil, but it attracts crowds in the USA. The fans enjoy seeing cars racing at speeds up to 250 mph, even if only for a few seconds. Many competitors are amateur mechanics that just attached rockets and other contraptions to create ultra-fast cars. 

<P>
Dragster competitions are elimination tournaments, where each confrontation consists of two competitors racing side by side and only one of them being declared the winner (the fastest one, obviously). The winners are then rematched into new races, until only one competitor remains - which is declared the winner. 

<P>
Rubens is an experienced pilot, with a racing career in several categories, including Formula 1. However, after facing some difficulties, he decided to dedicate himself to dragster racing. Using his vast experience from Formula 1, he can, observing the competitors, tell what is the probability each one would prevail during a race between any pair of them. 

<P>
Even though Rubens is a good pilot, he's not very good in math nor computing, so he asked your help to write a program that, given the probabilities computed by Rubens for all races between each pair of pilots, and the description of the tournament structure, determines his proability of winning the tournament.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001001000000000000000">
Input</A>&nbsp;</FONT>
</H2>
The input consists of several test cases. The first line of a test case contains a single integer <SPAN CLASS="MATH"><I>N</I></SPAN>, indicating the number of competitors in this tournament (<!-- MATH
 $2 \le  N \le  300$
 -->
<SPAN CLASS="MATH">2<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>N</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$">300</SPAN>). In the tournament descripton, each competitor is identified by an integer from 1 to <SPAN CLASS="MATH"><I>N</I></SPAN>, and the races are identified by integers from <SPAN CLASS="MATH"><I>N</I> + 1</SPAN> to <!-- MATH
 $2 \times N - 1$
 -->
<SPAN CLASS="MATH">2 <TT>x</TT> <I>N</I> - 1</SPAN>. Rubens is always identified by the number 1. The <SPAN CLASS="MATH"><I>N</I></SPAN> next lines describe the probability matrix computed by Rubens. The <SPAN CLASS="MATH"><I>i</I></SPAN>-th line contains <SPAN CLASS="MATH"><I>N</I></SPAN> real numbers 
<SPAN CLASS="MATH"><I>M</I>[<I>i</I>, <I>j</I>]</SPAN> separated by spaces (<!-- MATH
 $0 \le  M [i, j ] \le  1$
 -->
<SPAN CLASS="MATH">0<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>M</I>[<I>i</I>, <I>j</I>]<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$">1</SPAN>, for <!-- MATH
 $1 \le  i \le  N$
 -->
<SPAN CLASS="MATH">1<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>i</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>N</I></SPAN> and <!-- MATH
 $1 \le  j \le  N$
 -->
<SPAN CLASS="MATH">1<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>j</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>N</I></SPAN>). Each matrix entry 
<SPAN CLASS="MATH"><I>M</I>[<I>i</I>, <I>j</I>]</SPAN> indicates the probability of competitor <SPAN CLASS="MATH"><I>i</I></SPAN> winning a race against competitor <SPAN CLASS="MATH"><I>j</I></SPAN> (<!-- MATH
 $0.001 \le  M [i, j ] \le  0.999$
 -->
<SPAN CLASS="MATH">0.001<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>M</I>[<I>i</I>, <I>j</I>]<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$">0.999</SPAN> and <!-- MATH
 $M [i, j ] + M [j, i] = 1$
 -->
<SPAN CLASS="MATH"><I>M</I>[<I>i</I>, <I>j</I>] + <I>M</I>[<I>j</I>, <I>i</I>] = 1</SPAN> for <SPAN CLASS="MATH"><I>i</I><IMG
 WIDTH="18" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img2.png"
 ALT="$ \ne$"><I>j</I></SPAN> , and <!-- MATH
 $M [i, j ] = 0$
 -->
<SPAN CLASS="MATH"><I>M</I>[<I>i</I>, <I>j</I>] = 0</SPAN> for <SPAN CLASS="MATH"><I>i</I> = <I>j</I></SPAN>). The probabilities will always be given with three decimal places. Each one of the next <SPAN CLASS="MATH"><I>N</I> - 1</SPAN> lines contains two integers <SPAN CLASS="MATH"><I>A</I></SPAN>, <SPAN CLASS="MATH"><I>B</I></SPAN>, describing a race. <SPAN CLASS="MATH"><I>A</I></SPAN> and <SPAN CLASS="MATH"><I>B</I></SPAN> are race or competitor identifiers (<!-- MATH
 $1 \le  A \le  2 \times N - 1$
 -->
<SPAN CLASS="MATH">1<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>A</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$">2 <TT>x</TT> <I>N</I> - 1</SPAN> e <!-- MATH
 $1 \le  B \le  2 \times N - 1$
 -->
<SPAN CLASS="MATH">1<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$"><I>B</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11680img1.png"
 ALT="$ \le$">2 <TT>x</TT> <I>N</I> - 1</SPAN>). The first of these lines describes race <SPAN CLASS="MATH"><I>N</I> + 1</SPAN>, the next line describes race <SPAN CLASS="MATH"><I>N</I> + 2</SPAN>, and so on. When a race identifier <SPAN CLASS="MATH"><I>k</I></SPAN> appears in the input as <SPAN CLASS="MATH"><I>A</I></SPAN>, that means the winner of race <SPAN CLASS="MATH"><I>k</I></SPAN> will run against <SPAN CLASS="MATH"><I>B</I></SPAN>; similarly, when a race identifier <SPAN CLASS="MATH"><I>k</I></SPAN> appears as <SPAN CLASS="MATH"><I>B</I></SPAN>, the winner of race <SPAN CLASS="MATH"><I>k</I></SPAN> will run against <SPAN CLASS="MATH"><I>A</I></SPAN>. 

<P>
The end of input is indicated by a line containing a single zero.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001002000000000000000">
Output</A>&nbsp;</FONT>
</H2>
For each test case inthe input, your program should print a single line, containing a single real number, with six decimal places precision, indicating the probability of Rubens winning the tournament.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001003000000000000000">
Sample Input</A>&nbsp;</FONT>
</H2>

<P>
<PRE>
4
0.000 0.500 0.400 0.400
0.500 0.000 0.500 0.500
0.600 0.500 0.000 0.600
0.600 0.500 0.400 0.000
1 2
3 4
5 6
5
0.000 0.500 0.600 0.600 0.001
0.500 0.000 0.500 0.500 0.500
0.400 0.500 0.000 0.500 0.500
0.400 0.500 0.500 0.000 0.500
0.999 0.500 0.500 0.500 0.000
3 8
9 6
4 5
1 2
0
</PRE> 

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001004000000000000000">
Sample Output</A>&nbsp;</FONT>
</H2>

<P>
<PRE>
0.200000
0.225125
</PRE> 

<P>


<P>
<BR><HR>

</BODY>
</HTML>
</HTML>
