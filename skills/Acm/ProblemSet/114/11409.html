
<!--Converted with LaTeX2HTML 2K.1beta (1.48)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Ball Passing</TITLE>
<META NAME="description" CONTENT="Ball Passing">
<META NAME="keywords" CONTENT="htmlatex">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="htmlatex.css">

</HEAD>

<BODY LANG="EN" BGCOLOR=#FFFFFF>

<H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0000ff><TR><TD><B><FONT SIZE=5 COLOR=#FFff00>&nbsp;<A NAME="SECTION0001000000000000000000">
Ball Passing</A>&nbsp;</FONT></B></TABLE></CENTER>
</H1>

<P>
A new game is introduced. This game involves a perfect square number of players. 
Now, say n*n players participate in the game. These players have a unique number each which ranges 
from 1 to n*n both inclusive. The number is printed in the front and back of their T-Shirts. 
These n*n players arrange themselves such that the boundary formed by the whole set of players 
looks like an oval.

<P>
<DIV ALIGN="CENTER">
<!-- MATH
 $\epsfbox{p11409.eps}$
 -->
<IMG
 WIDTH="141" HEIGHT="232" ALIGN="BOTTOM" BORDER="0"
 SRC="p11409.gif"
 ALT="\epsfbox{p11409.eps}">
<tex2html_verbatim_mark>
</DIV>

<P>
The game involves 2 balls. One ball is given to player in the first line and one ball 
to player in the last line. Both the balls are passed towards the other corner as follows :

<P>

<OL>
<LI>If there is no more line in the direction of passing, then the ball passing continues in the opposite direction. 

<P>
<SPAN  CLASS="textbf">NOTE:</SPAN> However, direction reversal takes place only once. Passing gets halted when this condition occurs second time instead of changing the direction.
</LI>
<LI>The player carrying the ball passes the ball to the player, chosen at random from the set of players satisfying both the conditions below :
<DL COMPACT>
<DT>2.1.</DT>
<DD>The set of players consists of players in next line in the direction of passing for the corresponding ball.
</DD>
<DT>2.2.</DT>
<DD>Each player in the set of players has number less than the number of person carrying the ball.
 This is followed if the set contains at least one player.
</DD>
</DL>
</LI>
<LI>If the set of players formed by the above rules has no players, then the direction of passing is reversed for the ball and the person carrying the ball obviously starts the passing in that direction for that ball. 

<P>
<SPAN  CLASS="textbf">NOTE:</SPAN> However, direction reversal takes place only once. Passing gets halted when this condition occurs second time instead of changing the direction.
</LI>
<LI>When passing is halted for both the balls, the game comes to end.
</LI>
</OL>

<P>
<DIV ALIGN="CENTER">
<!-- MATH
 $\epsfbox{p11409.eps}$
 -->
<IMG
 WIDTH="141" HEIGHT="232" ALIGN="BOTTOM" BORDER="0"
 SRC="p11409.gif"
 ALT="\epsfbox{p11409.eps}">
<tex2html_verbatim_mark>
</DIV>

<P>
The following tables illustrate the possible movements for each ball for the instance shown above.

<P>

<P>
<BR>
<DIV ALIGN="CENTER">
BALL 1:
</DIV>
<P>
<DIV ALIGN="CENTER"><TABLE COLS=5 BORDER FRAME=BOX RULES=GROUPS>
<COLGROUP><COL ALIGN=CENTER><COLGROUP><COL ALIGN=LEFT><COLGROUP><COL ALIGN=LEFT><COLGROUP><COL ALIGN=LEFT><COLGROUP><COL ALIGN=LEFT>
<TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>
Set of players </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> Each player </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> Next Line </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> Corresponding </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> RESULT </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 
probably </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> in the </TD><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> set of players </TD><TD></TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 
carrying the </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> carrying set </TD><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> that the ball can </TD><TD></TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 
ball </TD><TD></TD><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> be passed to. </TD><TD></TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>9 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 9 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 5,8 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 5,8 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>5,8 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 5 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 8 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 

2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 6 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 4 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> REVERSE </TD></TR>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 4 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> REVERSE </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> <SPAN  CLASS="textit">HALT</SPAN> </TD></TR>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 5,8 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> <SPAN  CLASS="textit">HALT</SPAN> </TD></TR>
</TBODY>
</TABLE>

</DIV>

<P>

<P>
<BR>
<DIV ALIGN="CENTER">
BALL 2:
</DIV>
<P>
<DIV ALIGN="CENTER"><TABLE COLS=5 BORDER FRAME=BOX RULES=GROUPS>
<COLGROUP><COL ALIGN=CENTER><COLGROUP><COL ALIGN=LEFT><COLGROUP><COL ALIGN=LEFT><COLGROUP><COL ALIGN=LEFT><COLGROUP><COL ALIGN=LEFT>
<TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>
Set of players </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> Each player </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> Next Line </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> Corresponding </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> RESULT </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 
probably </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> in the </TD><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> set of players </TD><TD></TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 
carrying the </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> carrying set </TD><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> that the ball can </TD><TD></TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> 
ball </TD><TD></TD><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> be passed to. </TD><TD></TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>4 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 4 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> REVERSE </TD></TR>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2,6,7 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>1,2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 4(Reversed) </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> <SPAN  CLASS="textit">HALT</SPAN> </TD></TR>
<TR><TD></TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 5,8 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> REVERSE </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 2 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1,3 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> PASSED </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 1 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 4 </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> NILL </TD><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> <SPAN  CLASS="textit">HALT</SPAN> </TD></TR>
</TBODY>
</TABLE>

</DIV>

<P>

<P>
<BR>
Given the number <SPAN CLASS="MATH"><I>n</I></SPAN>
<tex2html_verbatim_mark>, the arrangement of <SPAN CLASS="MATH"><I>n</I> <TT>*</TT> <I>n</I></SPAN>
<tex2html_verbatim_mark> players and the player number <SPAN CLASS="MATH"><I>p</I></SPAN>
<tex2html_verbatim_mark> , return the 
probability that the player numbered <SPAN CLASS="MATH"><I>p</I></SPAN>
<tex2html_verbatim_mark> holds atleast one ball at atleast one point of time 
during the course of the game.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001001000000000000000">
Input</A>&nbsp;</FONT>
</H2>

<P>
The first line in the input file contains no. of test cases (<SPAN CLASS="MATH">&lt; 30</SPAN>
<tex2html_verbatim_mark>)

<P>
Each test case is separated by an empty line.

<P>
Each test case satisfies the following conditions:

<P>
Value of <SPAN CLASS="MATH"><I>n</I></SPAN>
<tex2html_verbatim_mark>(first line) ranges from 2 to 20 both inclusive.

<P>
Arrangement is represented by <!-- MATH
 $2 \ast n -1$
 -->
<SPAN CLASS="MATH">2 <TT>*</TT> <I>n</I> - 1</SPAN>
<tex2html_verbatim_mark> lines; Lines 1 to <SPAN CLASS="MATH"><I>n</I></SPAN>
<tex2html_verbatim_mark> have space separated list of <SPAN CLASS="MATH"><I>i</I></SPAN>
<tex2html_verbatim_mark> integers where <SPAN CLASS="MATH"><I>i</I></SPAN>
<tex2html_verbatim_mark> is the line number; Lines <SPAN CLASS="MATH"><I>n</I> + 1</SPAN>
<tex2html_verbatim_mark> to <!-- MATH
 $2 \ast n-i$
 -->
<SPAN CLASS="MATH">2 <TT>*</TT> <I>n</I> - <I>i</I></SPAN>
<tex2html_verbatim_mark> integers in space separated manner.

<P>
Each integer in arrangement lies between 1 and <SPAN CLASS="MATH"><I>n</I> <TT>*</TT> <I>n</I></SPAN>
<tex2html_verbatim_mark> inclusive.

<P>
Each integer occurs only once in arrangement (Unique).

<P>
The player number (line following the arrangement) lies between 1 and <SPAN CLASS="MATH"><I>n</I> <TT>*</TT> <I>n</I></SPAN>
<tex2html_verbatim_mark> both inclusive.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001002000000000000000">
Output</A>&nbsp;</FONT>
</H2>

<P>
The output should contain one line for every test case.

<P>
Each line in the output must be an integer, the floor value of ((The required probability (that player <SPAN CLASS="MATH"><I>p</I></SPAN>
<tex2html_verbatim_mark> holds at least one ball at least one point of time) <!-- MATH
 $\ast 10^{\wedge}9$
 -->
<SPAN CLASS="MATH"><TT>*</TT> 10<SUP><IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="11409img2.png"
 ALT="$\scriptstyle \wedge$"></SUP>9</SPAN>
<tex2html_verbatim_mark>) with no leading zeros.

<P>
If probability is <SPAN CLASS="MATH"><I>p</I></SPAN>
<tex2html_verbatim_mark>, output floor (<!-- MATH
 $p \ast 10^{\wedge}9$
 -->
<SPAN CLASS="MATH"><I>p</I> <TT>*</TT> 10<SUP><IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="11409img2.png"
 ALT="$\scriptstyle \wedge$"></SUP>9</SPAN>
<tex2html_verbatim_mark>). 
For case 1: probability is 0.166666666666666.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001003000000000000000">
Sample Input</A>&nbsp;</FONT>
</H2>

<P>
<PRE>
4
3
9
5 8
2 6 7
1 3
4
6

3
9
5 8
2 6 7
1 3
4
3

2
1
2 3
4
2

4
15
14 13
16 10 12
11 7 2 4
1 9 5
6 8
3
7
</PRE>

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001004000000000000000">
Sample Output</A>&nbsp;</FONT>
</H2>

<P>
<PRE>
166666666
583333333
500000000
291666666
</PRE>

<P>


<P>
<BR><HR>

</BODY>
</HTML>
</HTML>
