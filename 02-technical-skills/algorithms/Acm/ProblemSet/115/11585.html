<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>


	<title>Problem I: Nurikabe</title>
	<meta name="author" content="Zachary Friggstad">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head><body>

<h2>Problem I: Nurikabe</h2>

<font color="white"><img src="p11585a.png" alt="At least it's not a sudoku problem" width="400" align="right" border="5"></font>
<p>The puzzle Nurikabe is played on a grid.  Initially, each grid space is either
blank or contains a single number.  The goal is to shade in some of the blank
spaces to satisfy the following constraints:
</p><ul>
<li> Any two shaded spaces are connected
by some sequence of adjacent shaded spaces.
Two spaces are called adjacent if they share a side.
</li><li> For each of the unshaded spaces <em>b</em>, let <em>W<sub>b</sub></em> be the collection
of all unshaded spaces that can be reached from <em>b</em> by a sequence of adjacent unshaded
spaces.  Then, <em>W<sub>b</sub></em> contains exactly one numbered space and that number
is exactly the number of spaces in <em>W<sub>b</sub></em>.
</li><li> For any unshaded space <em>b</em>, there is a sequence of unshaded spaces
starting at <em>b</em> and ending at a space on the edge of the grid
where consecutive spaces in this sequence share a side or a corner.
</li><li> Finally, in every 2 x 2 subsquare there is at least one unshaded space.
</li></ul>

<p>The image shows an example of a Nurikabe puzzle and its solution.  Take care to verify all
four constraints are satisfied in the solution.  To help you understand the third constraint,
note that the middle cell containing the number 1 can reach the edge of the grid since
it shares a corner with a group of unshaded spaces containing the number 2.

</p><p align="center"><img src="p11585b.png" alt="Example Nurikabe">

</p><p>It is known that the problem of determining if a Nurikabe grid can be shaded to satisfy
the constraints is NP-complete.  Your task is much easier.  Given an initial grid and
a proposed shading, determine if the shading satisfies the constraints of the Nurikabe puzzle.

</p><p>Input begins with a single integer <em>t</em> that indicates
the number of grids to verify.
The first line of each case contains three integers <em>r,c,d</em>
where the grid has <em>r</em> rows and <em>c</em> columns (1&nbsp;≤&nbsp;<em>r,c</em>&nbsp;≤&nbsp;100).
Then, <em>d</em>
lines follow, each containing three integers <em>r',c',n</em>
meaning the grid cell at location (<em>r',c'</em>) contains the positive number <em>n</em>.
The upper-left grid space has coordinates (0,0), no space receives more
than one number, and no two numbered grid spaces will share an edge.
Finally, the shading data is specified 
by <em>r</em> strings of <em>c</em> characters each (one string per line).
The <em>j</em>'th character in the <em>i</em>'th row
of the shading data is '#' if the cell with coordinates (<em>i,j</em>) is shaded and '.'
if that cell is not shaded.
Each test case is preceded by a blank line.

</p><p>For each input case, output a line containing either <code>solved</code>
or <code>not solved</code> to indicate whether or not
the shading represents a solution to the puzzle.

</p><h3>Sample input</h3>
<pre>5

5 5 6
0 0 3
0 2 1
0 4 2
2 2 1
3 4 2
4 0 2
.#.#.
.###.
.#.##
###..
..###

5 5 6
0 0 3
0 2 1
0 4 2
2 2 1
3 4 3
4 0 2
.#.#.
.###.
.#.##
####.
..#..

2 3 1
0 0 2
.##
.##

2 2 1
0 0 1
..
##

2 2 2
0 0 1
1 1 1
.#
#.
</pre>

<h3>Sample output</h3>
<pre>solved
not solved
not solved
not solved
not solved
</pre>

<hr>
<em>Zachary Friggstad</em>

</body></html>
