<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=GB2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./p5.files/filelist.xml">
<title>Travel</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>ÅÓÐ¡Ãù</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>ÅÓÐ¡Ãù</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>181</o:TotalTime>
  <o:Created>2001-07-22T09:45:00Z</o:Created>
  <o:LastSaved>2001-07-22T09:45:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>352</o:Words>
  <o:Characters>2012</o:Characters>
  <o:Lines>16</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2470</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:UseFELayout/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:ËÎÌå;
	mso-font-kerning:1.0pt;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;<A NAME="SECTION0001000000000000000000">Problem F.Travel</A></FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>
<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Background</A></FONT></H2>
<P>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>Xiao Ming, a clever and lazy boy, is good at programming and sleeping.
He hated traveling by train very much. Nevertheless, tomorrow in the early
morning hours he will travel from Liuzhou to Xi¡¯an to in order to get to the
National Olympiad of Informatics in 2001 (NOI2001). Since he is afraid of
arriving too late and being excluded from the contest, he is looking for the
train which gets her to Xi¡¯an as early as possible. However he dislikes getting
to the station too early, so if there are several schedules with the same
arrival time, he will choose the one with the latest departure time.</span></p>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>Xiao Ming asks you to help him with his problem, so that she can sleep a
bit longer tomorrow. You are given a set of railroad schedules from which you
have to compute the fastest connection among those with the earliest arrival
time for going from one location to another. One good thing: Xiao Ming can
switch trains in zero time.</span></p>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Input</A></FONT></H2>
<P>
<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>The input file contains several scenarios. Each of them consists of 3
parts:</span></p>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>Part one lists the names of all cities connected by the railroads. It
starts with a line containing an integer C(1&lt;=C&lt;=100) followed by C lines
containing city names. These names consist of at most 20 letters.</span></p>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>Part two describes all the trains running <b style='mso-bidi-font-weight:
normal'>during the day.</b> It start with a number T&lt;=100 followed by T
train descriptions. Each train description consists of one line with a number
ti&lt;100 and ti more lines with a time and a city name, meaning that
passengers can get on or off the train at that time at that city. The times are
given in the 24-hour format hhmm.</span></p>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>Part three consists of three lines: Line one contains the earliest
possible starting time for the journey, line two the name of the city where he
starts, and line three the destination city. The two cities are always
different.</span></p>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>The end of the input file is marked by a line containing only a
zero(instead of C). Do not process this line.</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Output</A></FONT></H2>
<P>

<p class=MsoNormal><span lang=EN-US><span style="mso-spacerun: yes">&nbsp;
</span>For each scenario print one line solution. If a connection exists the
print 2 four-digit numbers, meaning hhmm, the starting time and the arriving
time. If not connection exists print a line containing ¡°No connection¡±.</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Sample Input</A></FONT></H2>
<P>
<p class=MsoNormal><span lang=EN-US>3</span></p>

<p class=MsoNormal><span lang=EN-US>Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>Guilin</span></p>

<p class=MsoNormal><span lang=EN-US>Xian</span></p>

<p class=MsoNormal><span lang=EN-US>3</span></p>

<p class=MsoNormal><span lang=EN-US>2</span></p>

<p class=MsoNormal><span lang=EN-US>0900 Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>1200 Guilin</span></p>

<p class=MsoNormal><span lang=EN-US>2</span></p>

<p class=MsoNormal><span lang=EN-US>1200 Guilin</span></p>

<p class=MsoNormal><span lang=EN-US>2200 Xian</span></p>

<p class=MsoNormal><span lang=EN-US>3</span></p>

<p class=MsoNormal><span lang=EN-US>0900 Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>1200 Guilin</span></p>

<p class=MsoNormal><span lang=EN-US>2300 Xian</span></p>

<p class=MsoNormal><span lang=EN-US>0800</span></p>

<p class=MsoNormal><span lang=EN-US>Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>Xian</span></p>

<p class=MsoNormal><span lang=EN-US>3</span></p>

<p class=MsoNormal><span lang=EN-US>Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>Guilin</span></p>

<p class=MsoNormal><span lang=EN-US>Xian</span></p>
<p class=MsoNormal><span lang=EN-US>1</span></p>

<p class=MsoNormal><span lang=EN-US>3</span></p>
<p class=MsoNormal><span lang=EN-US>0900 Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>1200 Guilin</span></p>

<p class=MsoNormal><span lang=EN-US>2300 Xian</span></p>

<p class=MsoNormal><span lang=EN-US>1000</span></p>

<p class=MsoNormal><span lang=EN-US>Liuzhou</span></p>

<p class=MsoNormal><span lang=EN-US>Xian</span></p>

<p class=MsoNormal><span lang=EN-US>0</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Sample Output</A></FONT></H2>
<P>
<p class=MsoNormal><span lang=EN-US>0900 2200</span></p>

<p class=MsoNormal><span lang=EN-US>No connection</span></p>

</div>

</body>

</html>
