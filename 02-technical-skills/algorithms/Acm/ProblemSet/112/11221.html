<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.O Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <title>UFRN Q.C. IV - C. Magic Square Palindromes</title>
  <LINK REL=StyleSheet HREF="styles/ufrnqc.css" TYPE="text/css" MEDIA=screen>
</head>
<body>
<div>
<img src="images/BRAZIL.gif" align="left" height="40"><img src="images/UFRN.jpg"
 align="right" height="40"></div>
<h1>C. Magic square palindromes</h1>
<h3>Time limit: 1s</h3>
 
<p> A magic square palindrome is a sentence whose characters can be
divided in a <math>K &times; K</math> square table with the property
that the original sentence can be read from the table in four
different ways:<br> </p>

 <ul>
   
  <li>Start from the <math>(1,1)</math> cell, move right until the end
of the line and than proceed to the next line.</li>

  <li>Start from the <math>(1,1)</math> cell, move down until the end
of the column and then proceed to the next column.</li>

  <li>Start from the <math>(K,K)</math> cell, move left until the
beginning of the line and then proceed to the previous line.</li>

  <li>Start from the <math>(K,K)</math> cell, move up until the
beginning of the column and then proceed to the previous column.</li>

</ul>

<p>"Sator arepo tenet opera rotas" is probably the most famous magic
square palindrome. We can arrange it in a <math>K=5 (5x5)</math> table
in the following way: </p>

<table
 style="background-color: rgb(255, 255, 255); margin-left: auto; margin-right: auto; text-align: left;"
 border="1" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td style="vertical-align: top;">s<br>
      </td>
      <td style="vertical-align: top;">a<br>
      </td>
      <td style="vertical-align: top;">t<br>
      </td>
      <td style="vertical-align: top;">o<br>
      </td>
      <td style="vertical-align: top;">r<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">a<br>
      </td>
      <td style="vertical-align: top;">r<br>
      </td>
      <td style="vertical-align: top;">e<br>
      </td>
      <td style="vertical-align: top;">p<br>
      </td>
      <td style="vertical-align: top;">o<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">t<br>
      </td>
      <td style="vertical-align: top;">e<br>
      </td>
      <td style="vertical-align: top;">n<br>
      </td>
      <td style="vertical-align: top;">e<br>
      </td>
      <td style="vertical-align: top;">t<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">o<br>
      </td>
      <td style="vertical-align: top;">p<br>
      </td>
      <td style="vertical-align: top;">e<br>
      </td>
      <td style="vertical-align: top;">r<br>
      </td>
      <td style="vertical-align: top;">a<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">r<br>
      </td>
      <td style="vertical-align: top;">o<br>
      </td>
      <td style="vertical-align: top;">t<br>
      </td>
      <td style="vertical-align: top;">a<br>
      </td>
      <td style="vertical-align: top;">s<br>
      </td>
    </tr>
  </tbody>
</table>

<p>Notice that the original sentence can be read from the table in the
four different ways described above.<br>

</p>
<h2>Input</h2>

<p>The first line of input gives the number of cases, <math>T</math>
(<math>1 &le; <b>T</b> &le; 60</math>). <math>T</math> test cases
follow. Each one contains one line <math>L</math>, such that <math>0
&lt; length(L) &lt; 10.000</math>, with the sentence (that can contain
characters [a-z], whitespace, comma, period, interrogation and
exclamation points and parentheses).  <span style="font-weight:
bold;">Please notice </span>that the magic square palindrome table
ignores all whitespace and punctuation symbols.<br> </p>

<h2>Output</h2>

<p>The output is comprised of two lines for each input data set. The
first line identifies the data set with a number (starting from one
and incrementing at each new data set). The second line gives the
dimension of the magic square palindrome table (the <math>K</math>
value described above) or the expression "No magic :(" if the sentence
is not a magic square palindrome.  </p>

<h2>Sample input</h2>

<pre>
3
sator arepo tenet opera rotas
this sentence is, quite clearly, not a magic square palindrome! but then again, you never know...
muse sun, eve.s e(y)es even use sum.
</pre>

<h2>Sample output</h2>

<pre>
Case #1:
5
Case #2:
No magic :(
Case #3:
5
</pre>

<hr>
<address>Problem setter: Daniel Amaral de Medeiros Rocha.<br>
Universidade Federal do Rio Grande do Norte Qualifying Contest IV, June
9th, 2007.</address>
</body>
</html>
