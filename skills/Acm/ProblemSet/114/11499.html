<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML>
<HEAD>
<TITLE>Longest Increasing Sub-sequence</TITLE>
</HEAD>
<BODY LANG="EN" BGCOLOR=#FFFFFF>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;Longest Increasing Sub-sequence</FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>

<H2><FONT COLOR=#0070E8>The Problem</FONT></H2>

<p>
The problem of determining the longest increasing sub-sequence in a
list of numbers is already a classic in programming competitions.
Despite this fact, that is the problem you must solve here. But, in order
to avoid having you yawning while solving the problem, we introduced a
small change: the list of numbers will be given as a
bidimensional matrix, and the increasing sequence must be "embedded" in a
submatrix of the original matrix.

<!--
Determinar a sub-sequência (contígua) crescente de maior comprimento
em uma lista de números é um problema já clássico em competições de
programação. Este é o problema que você deve resolver aqui, mas para não
deixar você bocejando de tédio enquanto o soluciona, introduzimos uma
pequena modificação: a lista de números é dada na forma de uma matriz
bidimensional e sequência de comprimento máximo está
``embutida'' em uma sub-matriz da matriz original.
-->

<p>
Let's define the problem more precisely. The linearization of a
bidimensional matrix is the concatenation of its lines, from the first
to the last. A submatrix is a rectangular region of a bidimensional matrix
(with sides paralel to the sides of the matrix).
The size of a submatrix is its number of elements. You must write a program that,
given a matrix of integers, determines the largest submatrix such that,
when linearized, results in an increasing sequence.

<!--
Vamos definir mais precisamente o problema. A linearização de uma
matriz bidimensional é a justaposição de suas linhas, da primeira à
última. Uma sub-matriz é uma região retangular de uma matriz. O
tamanho de uma sub-matriz é seu número de elementos.  Você deve
escrever um programa que, dada uma matriz de números inteiros, determine a
maior sub-matriz que, quando linearizada, resulta em uma
sequência crescente.
-->

The figure below shows some examples of submatrices of largest
size which contain increasing sequences. Notice that more than one
such a submatrix may exist in a given matrix.

<center>
<img src="p11499.png">
</center>
<!--
A figura abaixo mostra alguns exemplos de sub-matrizes de tamanho
máximo que contêm sub-sequências crescentes. Note que mais de uma
sub-matriz que contém uma sub-sequência de comprimento máximo pode
estar presente em uma mesma matriz.

\begin{center}
\epsfig{file=seq.eps}
\end{center}
-->

<H2><FONT COLOR=#0070E8>The Input</FONT></H2>

<p>
The input contains several test cases. The first line of a test case
contains two integers <i>N</i> and <i>M</i> indicating the matrix
dimensions (<i>1 &le; N,M &le; 600</i>). Each of the next <i>N</i>
lines contains <i>M</i> integers, separated by a space, describing the elements
of the matrix. Element <i>X<sub>i,j</sub></i> of the matrix is the <i>j</i>-th integer of the
<i>i</i>-th line in the input (<i>-10<sup>6</sup> &le;
X<sub>i,j</sub> &le; 10<sup>6</sup></i>).

<p>
The end of input is indicated by a line containing only two zeros,
separated by a space.


<!--
A entrada contém vários casos de teste.  A primeira linha de um caso
de teste contém dois inteiros $N$ e $M$ indicando as dimensões da
matriz ($1 &le; N,M &le; 600$). Cada uma das $N$ linhas seguintes
contém $M$ inteiros, separados por um espaço, descrevendo os elementos
da matriz. O elemento $X<sub</sub>{i,j}$ da matriz é $j$-ésimo inteiro da
$i$-ésima linha da entrada ($-10<sup><sup>6 &le; X<sub</sub>{i,j} &le; 10<sup><sup>6$). O final
da entrada é indicado por uma linha que contém apenas dois números
zero, separados por um espaço.
-->

<H2><FONT COLOR=#0070E8>The Output</FONT></H2>

<p>
For each test case in the input your program must print one single line,
containing the size of the largest sub-matrix that, when linearized,
results in an increasing sequence.

<!--
Para cada um dos casos de teste da entrada seu programa deve imprimir
uma única linha, contendo o número de elementos da maior sub-matriz que,
quando linearizada, resulta em uma sequência crescente.
-->

<H2><FONT COLOR=#0070E8>Sample Input</FONT></H2>
<P>
<PRE>
3 3
1 2 5
4 6 7
10 8 3
3 4
1 2 1 2
9 6 7 3
8 7 2 8
4 2
-23 -12
0 2
16 15
57 33
4 4
2 2 2 2
2 2 2 2
2 2 2 2
2 2 2 2
0 0
</PRE>
<P>
<H2><FONT COLOR=#0070E8>Sample Output</FONT></H2>
<P>
<PRE>
4
3
4
1
</PRE>
</BODY>
</HTML>
