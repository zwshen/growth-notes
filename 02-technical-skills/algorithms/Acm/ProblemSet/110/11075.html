<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="b_files/filelist.xml">
<link rel=Edit-Time-Data href="b_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem B - Collage</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Shahriar Manzoor</o:Author>
  <o:LastAuthor>Shahriar Manzoor</o:LastAuthor>
  <o:Revision>85</o:Revision>
  <o:TotalTime>272</o:TotalTime>
  <o:Created>2004-06-18T06:13:00Z</o:Created>
  <o:LastSaved>2006-08-31T05:35:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>518</o:Words>
  <o:Characters>2955</o:Characters>
  <o:Company>ACM/ICPC</o:Company>
  <o:Lines>24</o:Lines>
  <o:Paragraphs>6</o:Paragraphs>
  <o:CharactersWithSpaces>3467</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:Arial;
	font-weight:bold;}
h3
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:16.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	font-weight:bold;}
h5
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:18.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	mso-bidi-font-weight:bold;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
p.preformatted, li.preformatted, div.preformatted
	{mso-style-name:preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.StyleArial16pt
	{mso-style-name:"Style Arial 16 pt";
	mso-ansi-font-size:16.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	font-weight:bold;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="8194"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:28.0pt;mso-bidi-font-size:12.0pt;font-family:
Arial'>Problem B</span></b><span style='font-family:Arial'><br>
</span><b style='mso-bidi-font-weight:normal'><span style='font-size:20.0pt;
mso-bidi-font-size:24.0pt;font-family:Arial'>Collage</span></b><span
style='font-family:Arial'><br>
<b style='mso-bidi-font-weight:normal'>Input: </b><span style='mso-bidi-font-weight:
bold'>Standard Input<o:p></o:p></span></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'>Output: </span></b><span
style='font-family:Arial;mso-bidi-font-weight:bold'>Standard Output</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>Little <span class=SpellE>Johny</span>
has just learned to play around with a photo editing tool. He has become quite
an expert in a very short time. His signature works are some wonderful collages
created by pasting clipped parts of different photographs one on top of
another.</p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>While we don’t have the time and
tool to play like <span class=SpellE>Johny</span>, we do have the luxury to
simplify the task to mold it into a rather simple problem.</p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>Our clipped photographs are fixed
sized character grids representing some patterns. Parts of the grids may be
filled with the dot ‘.’ character representing transparent pixels, and the
remaining opaque pixels would be represented with lower case letters.<span
style='mso-spacerun:yes'>  </span>Here are two sample grids representing some
patterns:</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..xxx<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<span
  class=SpellE>x<span class=GramE>..</span>x</span><o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>....x<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>x...x<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.xx<span
  class=GramE>..</span><o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.....<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.....<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<span
  class=SpellE>oo</span><span class=GramE>..</span><o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>o</span>..<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..o..<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Grid
  1<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Grid
  2<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>To keep it simple, we would use
the same lower case letter in one grid. The lower case letter in one grid may
or may not be used in another grid.</p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>Our task is to place these grids
one on top of another in such a way that we can come up with a target pattern
(possibly of different size). Placing the grids one on another is simple, we
don’t have to bother about rotation, reflection, or any such transformation
except for translation. We need to ensure that an opaque pixel does not hide
another opaque pixel. Some part of a grid may be outside the Target Image when
the part outside, contains only transparent pixels. The following example shows
valid and invalid merging of Grid 1 and Grid 2:</p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>xxx</span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<span
  class=SpellE>x<span class=GramE>..x</span></span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=SpellE><span class=GramE>oox</span></span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span class=SpellE><span
  class=GramE><span style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>x</span></span><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>ox</span></span></span><span style='font-family:"Courier New";
  mso-bidi-font-family:"Times New Roman"'>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<span
  class=SpellE>xxo</span><span class=GramE>..</span><o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>xxx</span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<span
  class=SpellE>xoox</span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...ox.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span class=SpellE><span
  class=GramE><span style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>x</span></span><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>ox</span></span></span><span style='font-family:"Courier New";
  mso-bidi-font-family:"Times New Roman"'>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.xx...<o:p></o:p></span></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>xxx</span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<span
  class=SpellE>oo.x</span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=SpellE>o.x</span>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span class=SpellE><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>x.o.x</span></span><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.xx...<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Target
  1<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Valid<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Target
  2<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Valid<o:p></o:p></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Target
  3<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Invalid<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>Given the grids representing the
patterns and a grid representation of the target pattern itself, we want to
know whether it is possible to produce the target. As we can see, given Grid 1
and Grid 2, we could produce Target 1 and Target 2, but not Target 3.</p>

<span style='font-size:12.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:16.0pt;font-family:Arial'>Input<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'>There can be several test cases.
The first line of input gives you the number of test cases, T (1&#8804;T&#8804;1000).
Then T test cases follow. Each test case starts with the number of grids N
(1&#8804;N&#8804;14) representing the given patterns. Each of the patterns is
represented by a 5x5 grid containing lower case letters and dots only. A blank
line would follow every pattern. At the end of the N patterns, the target
pattern would be given. Two integers R, C (1&#8804;R, C&#8804;20) will give the
dimension of the grid representing the target. In the next R lines, the <span
class=SpellE>RxC</span> grid would present the target pattern. As with the N
patterns, the target would contain lower case letters and dots only. There will
be a blank line following this pattern.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:16.0pt;font-family:Arial'>Output<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'>For each of the test cases, you’d
have to print the serial number (Case x:)of the test case followed by “Yes” or
“No” depending on whether the target can be reached or not. You should note
that to achieve the target you must use each and every given pattern for that
test case exactly once. If there are duplicate patterns in a test case, you
must treat them as separate entities.</p>

<h1><span style='mso-bidi-font-weight:normal;mso-bidi-font-style:italic'>Sample
Input<span style='mso-spacerun:yes'>                             </span>Output
for Sample Input<o:p></o:p></span></h1>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='background:#CCCCCC;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=307 valign=top style='width:3.2in;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>2<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>2<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.....<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.x...<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>x</span>..<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.xxx.<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>xx</span>.<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.....<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...<span
  class=SpellE>yy</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>....y<o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=GramE><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>y</span></b></span><b
  style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;font-family:
  "Courier New";mso-bidi-font-family:"Times New Roman"'>....<o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=SpellE><span class=GramE><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>yy</span></b></span></span><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>...<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>5
  7<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...<span
  class=SpellE>yy</span><span class=GramE>..</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=SpellE>x.y</span><span class=GramE>..</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=SpellE><span class=GramE><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>y</span></b></span><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>x</span></span></b></span><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...<o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=SpellE><span class=GramE><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>yyxxx</span></b></span></span><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>..<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...xx<span
  class=GramE>..</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>2<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.....<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.x...<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>x</span>..<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.xxx.<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>xx</span>.<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.....<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...<span
  class=SpellE>yy</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=SpellE>y.y</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=GramE><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>y</span></b></span><b
  style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;font-family:
  "Courier New";mso-bidi-font-family:"Times New Roman"'>....<o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=SpellE><span class=GramE><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>yy</span></b></span></span><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>...<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>5
  7<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...<span
  class=SpellE>yy</span><span class=GramE>..</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=SpellE>y.y</span><span class=GramE>..</span><o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=SpellE><span class=GramE><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>y</span></b></span><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>..<span
  class=GramE>x</span></span></b></span><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>...<o:p></o:p></span></b></p>
  <p class=MsoNormal><span class=SpellE><span class=GramE><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>yyxxx</span></b></span></span><b style='mso-bidi-font-weight:
  normal'><span style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>..<o:p></o:p></span></b></p>
  <pre><b style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt'>...xx<span
  class=GramE>..</span></span></b><b><span style='mso-bidi-font-size:12.0pt'><o:p></o:p></span></b></pre></td>
  <td width=309 valign=top style='width:231.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:11.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Case
  1: Yes<o:p></o:p></span></b></p>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b
  style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;font-family:
  "Courier New";mso-bidi-font-family:"Times New Roman"'>Case 2: No<o:p></o:p></span></b></p>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></b></p>
  </td>
 </tr>
</table>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=2 width="100%" align=center>

</div>

<p class=MsoNormal><span class=SpellE>Problemsetter</span>: <span class=SpellE>Monirul</span>
<span class=SpellE>Hasan</span></p>

<p class=MsoNormal>Special Thanks: Shahriar Manzoor (Judge Data Preparation)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
