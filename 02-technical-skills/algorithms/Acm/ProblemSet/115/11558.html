
<!--Converted with LaTeX2HTML 2K.1beta (1.48)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Dinner</TITLE>
<META NAME="description" CONTENT="Dinner">
<META NAME="keywords" CONTENT="htmlatex">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="htmlatex.css">

</HEAD>

<BODY LANG="EN" BGCOLOR=#FFFFFF>

<H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0000ff><TR><TD><B><FONT SIZE=5 COLOR=#FFff00>&nbsp;<A NAME="SECTION0001000000000000000000">
Dinner</A>&nbsp;</FONT></B></TABLE></CENTER>
</H1>

<P>
<DIV ALIGN="CENTER">
<!-- MATH
 $\epsfbox{p115xx.eps}$
 -->
<IMG
 WIDTH="250" HEIGHT="300" ALIGN="right" BORDER="0"
 SRC="p11558.jpg"
 ALT="\epsfbox{p115xx.eps}">
<tex2html_verbatim_mark>
</DIV>

<P>
For several years now, the Nordic Conference on Partitions and
Combinatorics, NCPC, has had a growing number of participants. This
year the organizing team is expecting an all time high record in the
hundreds. Due to the politics of arranging this prestigious event, the
conference site was decided a long time ago to be the Grand H&#244;tel in
Stockholm.  The hotel has two large dining halls, but unfortunately,
each of these halls alone can only fit up to two thirds of the NCPC
participants, so the participants are going to have to be divided in
two groups.

<P>
This constraint calls for some thinking on behalf of the organizing
team for the conference dinner: could they come up with some division
of the participants in two parts, none of which is larger than <SPAN CLASS="MATH">2/3</SPAN>
<tex2html_verbatim_mark>
of the entire group, meeting some witty division rule suitable for the
occasion, which they could tell the participants for their amusement?
After all, as long as there is some grand logic rule to which of the
two dining halls you are being seated in, you (as a mathematician)
would be happy!  They thought for a while and came up with the
following idea for the division: Is there a year <SPAN CLASS="MATH"><I>Y</I></SPAN>
<tex2html_verbatim_mark> and a division of
the participants in two parts such that every pair in the first part
met for the first time some time <SPAN  CLASS="textit">before</SPAN> year <SPAN CLASS="MATH"><I>Y</I></SPAN>
<tex2html_verbatim_mark>, and every
pair in the second part met for the first time some time <SPAN  CLASS="textit">in or
after</SPAN> year <SPAN CLASS="MATH"><I>Y</I></SPAN>
<tex2html_verbatim_mark>?  Now this clearly qualified as an appropriate rule to
all of them, but the question was whether it would be possible?

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001001000000000000000">
Input</A>&nbsp;</FONT>
</H2>
The input file contains several test cases, each of them    as described below.

<P>
The first line of input contains an integer <!-- MATH
 $4 \le n \le 400$
 -->
<SPAN CLASS="MATH">4<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11558img2.png"
 ALT="$ \le$"><I>n</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11558img2.png"
 ALT="$ \le$">400</SPAN>
<tex2html_verbatim_mark>,
the number of participants, and <SPAN CLASS="MATH"><I>c</I></SPAN>
<tex2html_verbatim_mark>, the number of known first
encounters.  The next <SPAN CLASS="MATH"><I>c</I></SPAN>
<tex2html_verbatim_mark> lines are each in the format <SPAN CLASS="MATH"><I>a</I>&nbsp;<I>b</I>&nbsp;<I>y</I></SPAN>
<tex2html_verbatim_mark>,
meaning participant <SPAN CLASS="MATH"><I>a</I></SPAN>
<tex2html_verbatim_mark> and <SPAN CLASS="MATH"><I>b</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $1 \le a < b \le n$
 -->
<SPAN CLASS="MATH">1<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11558img2.png"
 ALT="$ \le$"><I>a</I> &lt; <I>b</I><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11558img2.png"
 ALT="$ \le$"><I>n</I></SPAN>
<tex2html_verbatim_mark>) met for the
first time in year <SPAN CLASS="MATH"><I>y</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $1948 \le y < 2008$
 -->
<SPAN CLASS="MATH">1948<IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11558img2.png"
 ALT="$ \le$"><I>y</I> &lt; 2008</SPAN>
<tex2html_verbatim_mark>).  No pair of participants
will appear more than once on the list, and every pair of participants
not in the list is assumed to have meet only now (in the year <SPAN CLASS="MATH">2008</SPAN>
<tex2html_verbatim_mark>).

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001002000000000000000">
Output</A>&nbsp;</FONT>
</H2>

<P>
For each test case, write to the output    on a line by itself, 
either the smallest year <SPAN CLASS="MATH"><I>Y</I></SPAN>
<tex2html_verbatim_mark> such that it is
possible to divide the participants in two parts, neither of which
contains more than <SPAN CLASS="MATH">2<I>n</I>/3</SPAN>
<tex2html_verbatim_mark> people, such that all people in the first
part first met before year <SPAN CLASS="MATH"><I>Y</I></SPAN>
<tex2html_verbatim_mark>, and all people in the second part
first met in or after year <SPAN CLASS="MATH"><I>Y</I></SPAN>
<tex2html_verbatim_mark>.  If there is no such year, output the
string '<TT>Impossible</TT>'.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001003000000000000000">
Sample Input</A>&nbsp;</FONT>
</H2>
<PRE>
4 6
1 2 1987
2 3 1987
1 3 1987
2 4 1987
1 4 1987
3 4 1987
6 3
1 2 1970
3 4 1980
5 6 1990
</PRE> 

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001004000000000000000">
Sample Output</A>&nbsp;</FONT>
</H2>
<PRE>
Impossible
1971
</PRE> 

<P>


<P>
<BR><HR>

</BODY>
</HTML>
</HTML>
