<!--
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<HTML>
<HEAD>
<TITLE>Tacos Panchita</TITLE>
<META NAME="description" CONTENT="Tacos Panchita">
<META NAME="keywords" CONTENT="panch">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2002 JA patch-1.4">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="panch.css">

</HEAD>

<BODY >
<H1 ALIGN="CENTER">Tacos Panchita</H1>
-->

<HTML>
<HEAD>
<TITLE>MIUP'2003: Problem A</TITLE>
</HEAD>

<BODY bgcolor="white">

<font color="#0000FF">
<H1>Problem A</H1>

<H1 align="center">Tacos Panchita</H1>
</font>

<P align="justify">
<P>

<!-- <H2><A NAME="SECTION00001000000000000000"> Background</A> </H2> -->
Panchita is established with a Tacos Shop in the desert of  North Mexico. To attract clients, she installed lots of signs like the one represented in Figure <A HREF="panch.html#sign">1</A> all over the desert. The signs are intended to point in the direction of the shop; however, Panchita's magnetic needle has a problem and only gives four directions: North, South, East and West. Thus, the signs only point to the shop with a certain approximation. In the desert, besides Panchita's shop and the signs, there is nothing more.

<P>

<DIV ALIGN="CENTER"><A NAME="sign"></A><A NAME="70"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figura 1:</STRONG>
Panchita's signs</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">    <IMG
 WIDTH="204" HEIGHT="181" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img1.png"
 ALT="\includegraphics[width=4.5cm, keepaspectratio]{sign.eps}">
    </DIV></TD></TR>
</TABLE>
</DIV>

<P>

<DIV ALIGN="CENTER"><A NAME="map"></A><A NAME="71"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figura 2:</STRONG>
Panchita's grid world</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
    <IMG
 WIDTH="634" HEIGHT="409" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img2.png"
 ALT="\includegraphics[width=14cm, keepaspectratio]{map.eps}">
    </DIV></TD></TR>
</TABLE>
</DIV>

<P>
Panchita is happy with her signs: people transversing the desert usually make a deviation from their original route to follow the signs up to the shop, and she makes money. Her life would be perfect if there were no windstorms in the desert. The problem is that the wind makes the signs rotate, as if they were weathercocks. After each storm, Panchita has to visit all the signs to fix their direction.

<P>

<H2><A NAME="SECTION00002000000000000000">
Simulating Panchita's Set-Up</A>
</H2>

<P>
We may simulate a simplification of Panchita's environment using a grid-based representation as the one in Figure <A HREF="panch.html#map">2</A>.  In this simulation, Panchita's shop is represented by a single dark position and signs by two neighbour dark positions.

<P>
Directions are defined as angles, taking the <I>East</I> direction as the <IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img3.png"
 ALT="$0^o$"> reference (e.g., <I>North</I> is <IMG
 WIDTH="27" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img4.png"
 ALT="$90^o$">, <I>North-West</I> is <IMG
 WIDTH="35" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img5.png"
 ALT="$135^o$">).

<P>
A sign rotates around one of its dark positions: we call it the sign's <I>pivot</I> position. This one corresponds to the side of the sign with an arrow shape (in Figure <A HREF="panch.html#sign">1</A>, the left side). That's why pivot positions are represented in Figure <A HREF="panch.html#map">2</A> with triangles.

<P>
Thus, a pivot position remains fixed in the map when a sign changes direction. The position that moves is called <I>movable</I> (see Figure <A HREF="panch.html#rot">3</A>).

<DIV ALIGN="CENTER"><A NAME="rot"></A><A NAME="72"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figura 3:</STRONG>
Signs rotate around pivot positions</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
    <IMG
 WIDTH="362" HEIGHT="225" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img6.png"
 ALT="\includegraphics[width=8cm, keepaspectratio]{rotation.eps}">
    </DIV></TD></TR>
</TABLE>
</DIV>

<P>
This representation obviously lacks lot of detail. Sign direction, for instance, can only be represented in multiples of <IMG
 WIDTH="27" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img7.png"
 ALT="$45^o$">. Therefore, we will assume that wind may  only leave signs pointing in directions which are multiples of <IMG
 WIDTH="27" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img7.png"
 ALT="$45^o$">.

 <!-- <H2><A NAME="SECTION00003000000000000000"> Problem</A> </H2>-->

<FONT color="#0000FF"><H2>Problem</H2></FONT>
<P align="justify"> 
<P>
Given a partial map of the desert after a windstorm, simulate the result of changing the signs' directions to North, South, East or West, so that all them point approximately to Tacos Panchita. Figure <A HREF="panch.html#wind">4</A> illustrates a hypothetical scenario. 

<P>

<DIV ALIGN="CENTER"><A NAME="wind"></A><A NAME="73"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figura 4:</STRONG>
Signs after a windstorm</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
    <IMG
 WIDTH="633" HEIGHT="410" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img8.png"
 ALT="\includegraphics[width=14cm, keepaspectratio]{windstorm.eps}">
    </DIV></TD></TR>
</TABLE>
</DIV>

<P>
The intended result is represented in Figure <A HREF="panch.html#map">2</A>:  a new map with the signs' directions changed by moving <I>movable</I> positions.

<P>
To determine a corrected sign direction, you must first compute the direction <IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img9.png"
 ALT="$\alpha$"> from Tacos Panchita to the sign's pivot position.  <IMG
 WIDTH="14" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img10.png"
 ALT="$\beta$">, the new direction from the pivot
to the respective movable position, will be the closest multiple of <IMG
 WIDTH="27" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img4.png"
 ALT="$90^o$">, i.e., <IMG
 WIDTH="14" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img10.png"
 ALT="$\beta$"> will be the multiple of <IMG
 WIDTH="27" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img4.png"
 ALT="$90^o$"> such that <!-- MATH
 $\alpha \in [\beta - 45^o, \beta + 45^o[$
 -->
<IMG
 WIDTH="154" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img11.png"
 ALT="$\alpha \in [\beta - 45^o, \beta + 45^o[$"> (note the closed left interval).

<P>
Figure <A HREF="panch.html#areas">5</A> illustrates this calculation: signs with pivots in area <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img12.png"
 ALT="$A$"> must point to West, those with pivots in area <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img13.png"
 ALT="$B$"> must point to South, and so on.

<DIV ALIGN="CENTER"><A NAME="areas"></A><A NAME="74"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figura 5:</STRONG>
New direction depends on the pivot position</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
    <IMG
 WIDTH="250" HEIGHT="250" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img14.png"
 ALT="\includegraphics[width=5.5cm, keepaspectratio]{areas.eps}">
    </DIV></TD></TR>
</TABLE>
</DIV>

<P>
The following assumptions will be taken:


<UL>
<LI>when correcting a sign's direction, only the movable position may be changed
</LI>
<LI>after a windstorm, there are no two objects "touching" each other
</LI>
<LI>in the given partial map, every sign occupies exactly two positions; after correcting the signs' directions, this may not be true, as the movable part of the sign may be out of the map and will not be represented
</LI>
</UL>

<P>

<!-- <H2><A NAME="SECTION00004000000000000000"> Input</A> </H2> -->
<FONT color="#0000FF"><H2>Input</H2></FONT>
<P align="justify">
<b>
The input will contain several test cases, each of them as described below.
Consecutive test cases are separated by a single blank line.
</b>
<p>
<p>
 
<P>
The input file consists of a variable number of lines as follows: 

First line: <!-- MATH
 $x  \hspace{5pt} y \hspace{5pt}  w \hspace{5pt} h$
 -->
<IMG
 WIDTH="67" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img15.png"
 ALT="$x \hspace{5pt} y \hspace{5pt} w \hspace{5pt} h$">

<P>
Next <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img16.png"
 ALT="$h$"> lines: <!-- MATH
 $n \hspace{5pt} p_1 \hspace{5pt} p_2 \hspace{5pt} \ldots \hspace{5pt} p_n$
 -->
<IMG
 WIDTH="116" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img17.png"
 ALT="$n \hspace{5pt} p_1 \hspace{5pt} p_2 \hspace{5pt} \ldots \hspace{5pt} p_n$">

<P>
where each <IMG
 WIDTH="17" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img18.png"
 ALT="$p_i$"> is the <IMG
 WIDTH="13" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img19.png"
 ALT="$x$"> coordinate of a pivot position in the current line. Lines are presented in descending order of their <IMG
 WIDTH="12" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img20.png"
 ALT="$y$"> coordinates. In each line, pivot coordinates are presented in ascending order.

<P>
Movable positions are not included in the input as they are not needed to solve the problem.

<P>

<!-- <H2><A NAME="SECTION00005000000000000000"> Output</A> </H2> -->
<FONT color="#0000FF"><H2>Output</H2></FONT>
<P align="justify">
<b>
For each test case, the output must follow the description below.
The outputs of two consecutive cases will be separated by a blank line.
</b>
<p>
<p>

<P>
Output should represent the map with the signs in the correct directions, and consist of a variable number of lines as follows: 

<P>
First line: <!-- MATH
 $x  \hspace{5pt} y \hspace{5pt}  w \hspace{5pt} h$
 -->
<IMG
 WIDTH="67" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img15.png"
 ALT="$x \hspace{5pt} y \hspace{5pt} w \hspace{5pt} h$">

<P>
where <IMG
 WIDTH="13" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img19.png"
 ALT="$x$"> and <IMG
 WIDTH="12" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img20.png"
 ALT="$y$"> are the (always positive) coordinates of Tacos Panchita's position, and <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img21.png"
 ALT="$w$"> and <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img16.png"
 ALT="$h$"> are the width and the height of the given map

<P>
Next <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img16.png"
 ALT="$h$"> lines: <!-- MATH
 $m \hspace{5pt} x_1 \hspace{5pt} x_2 \hspace{5pt} \ldots \hspace{5pt} x_m$
 -->
<IMG
 WIDTH="127" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img22.png"
 ALT="$m \hspace{5pt} x_1 \hspace{5pt} x_2 \hspace{5pt} \ldots \hspace{5pt} x_m$">

<P>
where each <IMG
 WIDTH="20" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img23.png"
 ALT="$x_j$"> is the <IMG
 WIDTH="13" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="p905img19.png"
 ALT="$x$"> coordinate of a movable position in the current line. Lines are presented in descending order of their <IMG
 WIDTH="12" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="p905img20.png"
 ALT="$y$"> coordinates. In each line, movable coordinates are presented in ascending order.

<P>
Pivot positions are not included in the output as they are kept unchanged.

<P>

<!-- <H2><A NAME="SECTION00006000000000000000"> Sample Input</A> </H2>
 -->
<FONT color="#0000FF"><H2>Sample Input</H2></FONT>
<P>
<PRE>
3 3 7 6
1 6
1 2
0
1 6
1 2
1 5
</PRE>

<P>

<!-- <H2><A NAME="SECTION00007000000000000000"> Sample Output</A> </H2> -->
<FONT color="#0000FF"><H2>Sample Output</H2></FONT>
<P>
<PRE>
3 3 7 6
1 2
0
0
1 7
0
2 2 6
</PRE>

<hr> 
<i>
Amílcar Cardoso, MIUP'2003<br>
(Portuguese National ACM Programming Contest)
</i>

</BODY>
</HTML>
