<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0053)http://www.cs.lth.se/contest/c99/problems/stitch.html -->
<HTML><HEAD><TITLE>Problem G - Stitching</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2600.0" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff>
<CENTER><FONT size=+2>Problem G 
<P>Stitching<br>Time Limit: 4 Seconds </FONT>
</CENTER>
<P><B>Statement of the problem</B><BR><IMG src="p10711a.gif" 
align=right> We want to reconstruct a surface from a two polygons. Think of it 
as if we sliced a volume (e.g. a CAT scan (på svenska ungefär skiktröntgen)) at 
two <I>z</I>-coordinates, converted these two planar contours into polygons, and 
we would now like to rebuild a surface of the body between the polygonal cuts 
from these polygons. In this problem, the resulting surface consists of 
triangles only. In the figure to the right, the objective is to "stitch" the 
square with the triangle. Notice that vertices of the tile triangles which 
combines these two contour polygons is vertices of the contour polygons, with 
the vertices of each tile taken two from one polygon and one from the other. 
<P><IMG src="p10711b.gif" align=left> Now suppose we have decided to 
form a triangle using P<SUB>1</SUB>,Q<SUB>1</SUB>,Q<SUB>2</SUB>, shown in the 
upper left picture. If the vertices of the contour are in counterclockwise order 
and we are forming triangles in counterclockwise order, we now have two options. 
Since the surface built must be without "holes", P<SUB>1</SUB> and Q<SUB>2</SUB> 
must be part of the next triangle. This leaves us with either taking the the 
next P-vertex, shown in the left bottom figure, or taking the next Q-vertex, 
shown in the right bottom figure. 
<P>Since each triangle uses one new vertex from the contour polygons, the 
resulting surface will consist of 7 (4+3) triangles. 
<P><IMG src="p10711c.gif" align=right> We would like to know the minimum 
possible area of such a surface. <B>One way</B> of solving this problem is to 
form a matrix. Suppose the number of vertices of the polygons are <I>m</I> and 
<I>n</I>. Then build a matrix with <I>m</I> rows and <I>n</I> columns. The 
position in the matrix corresponds to the two vertices that the next, new, 
triangle has in common with the last one. A movement to the right means that we 
are constructing a new triangle using a new vertex from the second polygon (Q), 
while a movement downwards means a new triangle using a vertex from the first 
polygon (P). The movement wraps at the rightmost column and the downmost row. In 
the example, we started with the points P<SUB>1</SUB> and Q<SUB>1</SUB>, and 
used the point Q<SUB>2</SUB> to from a triangle. Then we could either pick 
P<SUB>2</SUB> as our next point, a downward movement, or pick Q<SUB>3</SUB> as 
our next point, a rightward movement. Of course, the path must end up at the 
starting position. For each movement, a cost is associated, namely the area of 
the triangle. 
<P><IMG src="p10711d.gif" align=right> So, the optimization problem can 
be restated as the problem of finding a closed path with the minimum sum of the 
costs in the matrix grid, where each horizontal line on the grid is crossed 
exactly once by the path, and where each vertical line on the grid is crossed 
exactly once by the path, as in the figure to the right. 
<P>Hint. One simple formula to calculate the area of a triangle is Heron's 
formula: <IMG src="p10711e.gif">, where <I>a</I>, <I>b</I> and <I>c</I> 
are the lengths of the sides, and <I>p</I> is the semiperimeter 
(<I>a</I>+<I>b</I>+<I>c</I>)/2. 
<P><B>Input</B> <BR>The input starts with a single number on a line, <I>N</I>, 
which stands for the number of test cases. Following this line are the <I>N</I> 
test cases. Each test case starts with three numbers <I>m</I>, <I>n</I>, 
<I>z</I><SUB>1</SUB>. <I>m</I> and <I>n</I> are integers, greater than 2 but 
less than or equal to 20. <I>m</I> stands for the number of points in the first 
polygon and <I>n</I> stands for the number of points in the second polygon. 
<I>z</I><SUB>1</SUB> is a real positive number which stands for the 
<I>z</I>-coordinates for the vertices in the second polygon. The 
<I>z</I>-coordinates for the vertices in the first polygon is zero. Following 
this line are <I>m</I>+<I>n</I> lines with <I>x</I>- and <I>y</I>-coordinates of 
the simple, not necessarily convex, polygons in counterclockwise order. All 
coordinates are real numbers. First are the coordinates for the first polygon, 
followed by the coordinates for the second polygon. 
<P><B>Output</B> <BR>For each test case, output the minimum area of the surface 
connecting the both polygons, using five decimal digits. However, trailing zeros 
may be omitted. The output is a real number. A relative error of up to 0.01% is 
allowed. 
<P><B>Example</B> <PRE>Input:        Output:
2             3.72474
4 3 1         8.00000
0 0
1 0
1 1
0 1
0 0
1 0
0.5 1
4 4 2
0 0
1 0
1 1
0 1
0 0
1 0
1 1
0 1



</PRE></BODY></HTML>
