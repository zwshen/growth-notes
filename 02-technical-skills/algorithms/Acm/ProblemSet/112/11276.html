<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Magical Seven</TITLE>
</HEAD>
<BODY LANG="EN" BGCOLOR=#FFFFFF>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;<A NAME="SECTION0001000000000000000000">G. Magical Seven</A></FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Problem</A></FONT></H2>


<P><b>7</b> is a very special number.  It is the smallest number that can't be represented as a sum of fewer than four non-zero squares.
It is also the smallest happy number greater than 1.  <b>7</b> is considered to be magical in many cultures.  In this problem,
you will discover the amazing hidden magic of <b>7</b> in graph theory :-).
<P>
Given a grid graph <b>G</b>, with dimensions <b>7 x n</b>, as shown below (the vertices are at the center of the grid cells).  
Compute the last 4 digits of <b>A</b>+<b>B</b>+<b>C</b>, where
<P>
<b>A</b> = The total number of different Perfect matchings of <b>G</b>.  A Perfect matching is a matching which covers all vertices of <b>G</b>.
<P>
<b>B</b> = The total number of different Hamiltonian cycles of <b>G</b>.  A Hamiltonian cycle visits each vertex exactly once and comes back to the original vertex.
<P>
<b>C</b> = The total number of different Spanning subgraphs of <b>G</b>, such that every connected component of each Spanning subgraph is a cycle.

<H1 ALIGN=center>
<IMG SRC="p11276.gif" width="395" height="116" border="0">
</H1>

</U></U><H2><FONT COLOR=#0070E8><A NAME="SECTION0001003000000000000000">The Input</A></FONT></H2>
<P>
The input will consist of at most 100 lines with the value of <b>n</b> on each line.  All numbers fit into unsigned 64 bit integers.

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001004000000000000000">The Output</A></FONT></H2>
<P>
For each line of input, output the answer on a single line.  If there are fewer than 4 digits in <b>A</b>+<b>B</b>+<b>C</b>, pad to
4 digits with leading 0's, otherwise output the last 4 digits as described above.

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001005000000000000000">Sample Input</A></FONT></H2>
<P>
<PRE>
1
2
6
10
</PRE>
<P>
<H2><FONT COLOR=#0070E8><A NAME="SECTION0001006000000000000000">Sample Output</A></FONT></H2>
<P>
<PRE>
0000
0030
5900
5765
</PRE>
</BODY>
</div>
<br />

<hr size="1" />
Problem setter: Josh Bao
Alternative Solution: Mike Liu
<br />
</HTML>
