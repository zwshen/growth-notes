
<!--Converted with LaTeX2HTML 2K.1beta (1.48)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Angry Programmer</TITLE>
<META NAME="description" CONTENT="Angry Programmer">
<META NAME="keywords" CONTENT="htmlatex">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="htmlatex.css">

</HEAD>

<BODY LANG="EN" BGCOLOR=#FFFFFF>

<H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0000ff><TR><TD><B><FONT SIZE=5 COLOR=#FFff00>&nbsp;<A NAME="SECTION0001000000000000000000">
Angry Programmer</A>&nbsp;</FONT></B></TABLE></CENTER>
</H1>
You, a programmer of an important software house, have been fired because you didn't solve an important problem that was assigned to you. You are very furious and want to take revenge on your boss, breaking the communication between his computer and the central server.

<P>

<P><P>
<BR>
The computer of your boss and the central server are in the same network, which is composed of many machines (computers) and wires linking pairs of those machines. There is at most one wire between any pair of machines and there can be pairs of machines without a wire between them.

<P>

<P><P>
<BR>
To accomplish your objective, you can destroy machines and wires, but you can't destroy neither the computer of your boss nor the central server, because those machines are monitored by security cameras. You have estimated the cost of blowing up each machine and the cost of cutting each wire in the network.

<P>

<P><P>
<BR>
You want to determine the minimum cost of interrupting the communication between your boss' computer and the central server. Two computers <SPAN CLASS="MATH"><I>A</I></SPAN>
<tex2html_verbatim_mark> and <SPAN CLASS="MATH"><I>B</I></SPAN>
<tex2html_verbatim_mark> can communicate if there is a sequence of undestroyed machines <!-- MATH
 $x_{1}, \dots,x_{n}$
 -->
<SPAN CLASS="MATH"><I>x</I><SUB>1</SUB>,..., <I>x</I><SUB>n</SUB></SPAN>
<tex2html_verbatim_mark> such that <SPAN CLASS="MATH"><I>x</I><SUB>1</SUB> = <I>A</I></SPAN>
<tex2html_verbatim_mark>, <SPAN CLASS="MATH"><I>x</I><SUB>n</SUB> = <I>B</I></SPAN>
<tex2html_verbatim_mark> and <SPAN CLASS="MATH"><I>x</I><SUB>i</SUB></SPAN>
<tex2html_verbatim_mark> is linked with <SPAN CLASS="MATH"><I>x</I><SUB>i+1</SUB></SPAN>
<tex2html_verbatim_mark> with an uncut wire (for each <!-- MATH
 $1 \leq i \leq n-1$
 -->
<SPAN CLASS="MATH">1 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>i</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>n</I> - 1</SPAN>
<tex2html_verbatim_mark>).

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001001000000000000000">
Input</A>&nbsp;</FONT>
</H2>

<P>
The input consists of several test cases. Each test case is represented as follows:

<P>

<UL>
<LI>A line with two integers <SPAN CLASS="MATH"><I>M</I></SPAN>
<tex2html_verbatim_mark> and <SPAN CLASS="MATH"><I>W</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $2 \leq M \leq 50$
 -->
<SPAN CLASS="MATH">2 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>M</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> 50</SPAN>
<tex2html_verbatim_mark>, <!-- MATH
 $0 \leq W \leq 1000$
 -->
<SPAN CLASS="MATH">0 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>W</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> 1000</SPAN>
<tex2html_verbatim_mark>), representing (respectively) the number of machines and the number of wires in the network.
</LI>
<LI><SPAN CLASS="MATH"><I>M</I> - 2</SPAN>
<tex2html_verbatim_mark> lines, one per machine (different from the boss' machine and the central server), containing the following information separated by spaces:

<UL>
<LI>An integer <SPAN CLASS="MATH"><I>i</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $2 \leq i \leq M - 1$
 -->
<SPAN CLASS="MATH">2 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>i</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>M</I> - 1</SPAN>
<tex2html_verbatim_mark>) with the identifier of the machine. Assume that the boss' machine has id <SPAN CLASS="MATH">1</SPAN>
<tex2html_verbatim_mark> and that the central server has id <SPAN CLASS="MATH"><I>M</I></SPAN>
<tex2html_verbatim_mark>.
</LI>
<LI>An integer <SPAN CLASS="MATH"><I>c</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $0 \leq c \leq 100000$
 -->
<SPAN CLASS="MATH">0 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>c</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> 100000</SPAN>
<tex2html_verbatim_mark>) specifying the cost of destroying the machine.
</LI>
</UL>
</LI>
<LI><SPAN CLASS="MATH"><I>W</I></SPAN>
<tex2html_verbatim_mark> lines, one per wire, containing the following information separated by spaces:

<UL>
<LI>Two integers <SPAN CLASS="MATH"><I>j</I></SPAN>
<tex2html_verbatim_mark> and <SPAN CLASS="MATH"><I>k</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $1 \leq j < k \leq M$
 -->
<SPAN CLASS="MATH">1 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>j</I> &lt; <I>k</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>M</I></SPAN>
<tex2html_verbatim_mark>) specifying the identifiers of the machines linked by the wire. Remember that the wire is bidirectional.
</LI>
<LI>An integer <SPAN CLASS="MATH"><I>d</I></SPAN>
<tex2html_verbatim_mark> (<!-- MATH
 $0 \leq d \leq 100000$
 -->
<SPAN CLASS="MATH">0 <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> <I>d</I> <IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="11506img1.png"
 ALT="$ \leq$"> 100000</SPAN>
<tex2html_verbatim_mark>) specifying the cost of cutting the wire.
</LI>
</UL>
</LI>
</UL>

<P>

<P><P>
<BR>
The end of the input is specified by a line with the string ``<TT>0 0</TT>''.

<P>

<P><P>
<BR>
Suppose that the machines have distinct identifiers.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001002000000000000000">
Output</A>&nbsp;</FONT>
</H2>

<P>
For each test case, print a line with the minimum cost of interrupting the communication between the computer of your boss and the central server.

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001003000000000000000">
Sample Input</A>&nbsp;</FONT>
</H2>

<P>
<PRE>
4 4
3 5
2 2
1 2 3
1 3 3
2 4 1
3 4 3
4 4
3 2
2 2
1 2 3
1 3 3
2 4 1
3 4 3
0 0
</PRE>

<P>

<H2><FONT size=4 COLOR=#ff0000><A NAME="SECTION0001004000000000000000">
Sample Output</A>&nbsp;</FONT>
</H2>
<PRE>
4
3
</PRE>

<P>


<P>
<BR><HR>
<ADDRESS>
Colombia'2008
</ADDRESS>
</BODY>
</HTML>
</HTML>
