<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.O Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>UFRN Q.C. IV - J. Transportation system</title>
<LINK REL=StyleSheet HREF="styles/ufrnqc.css" TYPE="text/css" MEDIA=screen>
</head>

<body>

<div>
<img src="images/BRAZIL.gif" height="40px" align="left">
<img src="images/UFRN.jpg" height="40px" align="right">
</div>

<h1>J. Transportation system</h1>

<h3>Time limit: 2s</h3>

<p> In the country of Graphland, there are many cities but no
roads. The federal government wants to change this situation and plans
to build roads and railroads such that all the cities in the country
are connected through this new transportation system. To make the new
system more efficient, Graphland will build only roads between cities
within the same state and will use railroads to connect cities that
are in different states. For the purposes of this problem, consider
that if the distance between any two cities is at most <math>r</math> then
they are in the same state. To minimize the costs of building the
roads and railroads, the government also wants to build only the
minimum necessary extension of roads and railroads such that there is
a path between any pair of cities in the entire country. You've been
hired to determine what's the optimum transportation network system
that Graphland must build.  </p>

<p> The first line of the input contains the number of test cases that
follow. On the first line of each test case, there will be two
integers, <math>n</math> (<math>1 &le; n &le; 1000</math>), the number
of cities that comprise Graphland, and <math>r</math> (<math>0 &le; r
&le; 40000</math>), the threshold value to determine if two cities are
in the same state. On the following <math>n</math> lines, there will
be a list of <math>x-y</math> (<math>-10000 &le; x, y &le;
10000</math>) integer coordinates in the plan for each city in
Graphland. Your program must output the number of states in Graphland
and the minimum extension (rounded to the nearest integer) of both
roads and railroads that must be built to satisfy the conditions of
the project.  </p>

<h2>Input</h2>

<p>The first line of input gives the number of cases, <math>T</math>
(<math>1 &le; T &le; 20</math>). <math>T</math> test cases follow. On
the first line of each test case, there will be two integers,
<math>n</math> (<math>1 &le; n &le; 1000</math>), the number of cities
that comprise Graphland, and <math>r</math> (<math>0 &le; r &le;
40000</math>), the threshold value to determine if two cities are in
the same state. On the following <math>n</math> lines, there will be a
list of <math>x-y</math> (<math>-10000 &le; x, y &le; 10000</math>)
integer coordinates in the plan for each city in Graphland. </p>

<h2>Output</h2>

<p>The output is comprised of one line for each input data set. The
line identifies the data set with a number (starting from one and
incrementing at each new data set), followed by the number of states
in Graphland and the minimum extension (rounded to the nearest
integer) of both roads and railroads that must be built to satisfy the
conditions of the project.  </p>

<h2>Sample input</h2>

<pre>
3
3 100
0 0
1 0
2 0
3 1
0 0
100 0
200 0
4 20
0 0
40 30
30 30
10 10
</pre>

<h2>Sample output</h2>

<pre>
Case #1: 1 2 0
Case #2: 3 0 200
Case #3: 2 24 28
</pre>

<hr />
<address>Problem setter: Herbert de Melo Duarte.<br />
Universidade Federal do Rio Grande do Norte Qualifying Contest IV, June 9th, 2007.</address>

</body>

</html>
