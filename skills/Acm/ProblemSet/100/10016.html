<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.73 [en] (Win98; U) [Netscape]">
   <title>Flip-Flop the Squarelotron</title>
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
</head>
<body bgcolor="#FFFFFF" LANG="EN">
&nbsp;
<center><table BGCOLOR="#0060F0" >
<tr>
<td><a NAME="SECTION0001000000000000000000"></a><b><font color="#C0FFFF"><font size=+2>Flip-Flop
the Squarelotron</font></font></b></td>
</tr>
</table></center>

<h2>
<a NAME="SECTION0001002000000000000000"></a><font color="#0070E8">The Problem</font></h2>
Anita is the baby siter of Baron Von Hauser’ kids, a famous Physics Assistant
of ITESM Campus Monterrey Physics department. As such Von Hauser kids have
weird toys, all of which Anita has to master to be able to effectively
entertain Baron&acute; Kids.
<p>While Anita was cleaning the bathtub she found a new toy. It is extremely
weird, and posses a lot of mathematical symmetry, it is a Squarelotron
game. She is determined to understand this new toy, otherwise she won&acute;t
be able to play with Von Hauser’ kids. However the complexity of such extreme
toy makes it dificult to play. That’s why Anita asked the judges of this
ITESM Campus Monterrey internal ACM programming contest eliminatory to
put this problem, so that answers could be given by the best sttudents
of computer science and engineering of this Campus.
<p>A Squarelotron consist basically of a matrix of numbers. However this
matrix can be decomposed as squared rings which can rotate independently
in 4 diferent ways, Upside-Down, Left-Rigt, through the Main Inverse Diagonal
and through the Main Diagonal.
<p>For example Consider the following Squarelotrons.
<p><img SRC="p10016a.jpg" height=217 width=407>
<br>Squarelotron a) as 2 rings while squarelotron b) has 3.
<p>A Upside-Down Flip of the outmost ring of Squarelotron a) yields:
<br><img SRC="p10016b.jpg" NOSAVE height=137 width=149>
<br>&nbsp;
<br>&nbsp;
<p>A Left-Rigth Flip of the 2 ring of squarelotron b) yields:
<br><img SRC="p10016c.gif" height=169 width=171>
<br>&nbsp;
<p>A Flip through&nbsp; the Main Inverse Diagonal of the second ring of
squarelotron a) yields:
<br><img SRC="p10016d.gif" height=132 width=135>
<br>&nbsp;
<p>A Flip through the Main Diagonal of the outermost ring of squarelotron
b) yields:
<br><img SRC="p10016e.gif" height=161 width=163>
<p>Anita wants you to do a program which performs the following. She will
give you a Squarelotron and your program will perform several of the flips
described earlier for each of the rings of the given Squarelotron. The
output of your program should be the final state of the Squarelotron.
<br>&nbsp;
<h2>
<a NAME="SECTION0001003000000000000000"></a><font color="#0070E8">The Input</font></h2>
The first line contains the number M of different cases to process, consisting
of blocks of lines.
<br>Each of these blocks consist of the following.
<br>The first line of each block contains a number N which describes the
order N x N&nbsp; of the Squarelotron.
<br>Following comes N lines of N numbers each, which describes the Squarelotron
itself.
<br>Next comes an equal number of lines as number of rings of the Squarelotron.
Each of these lines begins with a number T, followed by T numbers C which
identifies the move to perform on the ring.
<p>All these numbers are in the following ranges:
<br>0&lt;M&lt;=1000
<br>1&lt;=N&lt;101
<br>0&lt;T&lt;= Number of Rings
<br>1&lt;=C&lt;5
<br>The numbers in the squarelotron are smaller than 2^16.
<p>The Moves are identifies as follows. 1 means Upside-Down Flip, 2 Means
Left-Right Flip, 3 means flip through the Main&nbsp; Diagonal, 4 means
a flip through the Main Inverse Diagonal.
<br>&nbsp;
<h2>
<a NAME="SECTION0001004000000000000000"></a><font color="#0070E8">The Output</font></h2>
For each of the M cases, output a a N x N squarelotron at the state it
is supposed to be after all the moves. This squarelotron should be N lines
with N numbers each. No blank line in between each case should be output.
<h2>
<a NAME="SECTION0001005000000000000000"></a><font color="#0070E8">Sample
Input</font></h2>

<pre>4
3
1 2 3
4 5 6
7 8 9
2 1 2
4 1 2 3 4
4
1 2 3 4
5 6 7 8
9 1 2 3
4 5 6 6
2 1 2
2 3 4
5
1 2 3 4 5
6 7 8 9 1
2 3 4 5 6
7 8 9 1 2
3 4 5 6 7
2 3 4
2 1 3
4 1 3 2 4
6
1 2 3 4 5 6
7 8 9 1 2 3
4 5 6 7 8 9
1 2 3 4 5 6
7 8 9 1 2 3
4 5 6 7 8 9
2 4 1&nbsp;
2 2 3
1 1</pre>

<h2>
<a NAME="SECTION0001006000000000000000"></a><font color="#0070E8">Sample
Output</font></h2>

<pre>9 8 7
6 5 4
3 2 1
6 6 5 4
3 2 1 9
8 7 6 5
4 3 2 1
7 6 5 4 3
2 8 3 7 7
6 9 4 8 2
1 1 5 9 6
5 4 3 2 1
4 7 1 4 7 1
5 2 8 5 2 2
6 1 3 4 1 3
7 9 6 7 9 4
8 8 5 2 8 5
9 3 6 9 3 6</pre>

</body>
</html>
