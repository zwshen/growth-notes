<!-- saved from url=(0022)http://internet.e-mail -->
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./d_files/filelist.xml">
<link rel=Edit-Time-Data href="./d_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem D - Treasure Castle</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Andreas Björklund</o:Author>
  <o:LastAuthor>Shahriar Manzoor</o:LastAuthor>
  <o:Revision>42</o:Revision>
  <o:TotalTime>75</o:TotalTime>
  <o:Created>2004-10-01T07:34:00Z</o:Created>
  <o:LastSaved>2004-10-29T05:18:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>357</o:Words>
  <o:Characters>2037</o:Characters>
  <o:Company>Axiom4</o:Company>
  <o:Lines>16</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2501</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
span.SPELLE
	{mso-spl-e:yes;}
 /* Font Definitions */
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:647 134676480 16 0 131231 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:SV;
	mso-fareast-language:SV;}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;
	mso-ansi-language:SV;
	mso-fareast-language:SV;
	font-weight:bold;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	mso-fareast-language:SV;
	font-weight:normal;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;
	mso-ansi-language:SV;
	mso-fareast-language:SV;
	font-weight:bold;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	mso-layout-grid-align:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:SimSun;
	mso-ansi-language:SV;
	mso-fareast-language:ZH-CN;
	font-weight:bold;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:SV;
	mso-fareast-language:SV;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:SV;
	mso-fareast-language:SV;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:SV;
	mso-fareast-language:SV;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Arial Unicode MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";}
tt
	{mso-ascii-font-family:"Arial Unicode MS";
	mso-fareast-font-family:"Arial Unicode MS";
	mso-hansi-font-family:"Arial Unicode MS";
	mso-bidi-font-family:"Arial Unicode MS";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt .8in 70.85pt .8in;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1031"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">  </w:LatentStyles>
</xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:65.2pt'>

<div class=Section1>

<p class=MsoPlainText align=center style='text-align:center'><b><span lang=SV
style='font-size:28.0pt;mso-bidi-font-size:18.0pt;font-family:Arial'>Problem D</span></b><span
lang=SV style='font-family:Arial'><br>
</span><b><span lang=EN-GB style='font-size:20.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-GB'>Treasure
Castle</span></b></p>

<p class=MsoPlainText align=center style='text-align:center'><b><span lang=SV
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Input:</span></b><span
lang=SV style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>
standard input<o:p></o:p></span></p>

<p class=MsoPlainText align=center style='text-align:center'><b><span lang=SV
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Output:</span></b><span
lang=SV style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>
standard output<br>
<b>Time Limit:</b> 1 seconds<o:p></o:p></span></p>

<p class=MsoPlainText align=center style='text-align:center'><span lang=SV
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText align=center style='text-align:center'><span lang=EN-GB
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
mso-ansi-language:EN-GB'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText style='mso-layout-grid-align:auto;text-autospace:ideograph-other'><span
lang=SV>The treasure hunting chapter of iCORE (international Conference of
Revolver Enthusiasts) has just acquired a map of a castle which is now in ruins
but its cellars contain an unimaginable treasure. The map is drawn on an
orthogonal integer lattice. The coordinates of the lower left corner of the
lattice are (-10000,&nbsp;-10000) while the coordinates of the upper right
corner are (10000,&nbsp;10000). The external walls of the castle are either
horizontal or vertical and always span a distance between the towers of the
castle. Walls do not cross and if they have a point in common then it is a
tower of the castle. Exactly two walls meet at each tower. The towers are
located at grid points. The grid lines not outside the walls of the castle
correspond to underground corridors. The map indicates that at one of the grid
points there is an entrance to the underground corridors and that at another
grid point the long sought for treasure is to be found. </span></p>

<p class=MsoNormal><!--[if gte vml 1]><o:wrapblock><v:shapetype id="_x0000_t75"
  coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
  filled="f" stroked="f">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="if lineDrawn pixelLineWidth 0"/>
   <v:f eqn="sum @0 1 0"/>
   <v:f eqn="sum 0 0 @1"/>
   <v:f eqn="prod @2 1 2"/>
   <v:f eqn="prod @3 21600 pixelWidth"/>
   <v:f eqn="prod @3 21600 pixelHeight"/>
   <v:f eqn="sum @0 0 1"/>
   <v:f eqn="prod @6 1 2"/>
   <v:f eqn="prod @7 21600 pixelWidth"/>
   <v:f eqn="sum @8 21600 0"/>
   <v:f eqn="prod @7 21600 pixelHeight"/>
   <v:f eqn="sum @10 21600 0"/>
  </v:formulas>
  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
  <o:lock v:ext="edit" aspectratio="t"/>
 </v:shapetype><v:shape id="_x0000_s1027" type="#_x0000_t75" style='position:absolute;
  margin-left:126pt;margin-top:25.8pt;width:225pt;height:175.3pt;z-index:1;
  mso-position-horizontal:absolute;mso-position-horizontal-relative:text;
  mso-position-vertical:absolute;mso-position-vertical-relative:text'>
  <v:imagedata src="./d_files/image001.wmz" o:title=""/>
  <w:wrap type="topAndBottom"/>
 </v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0 align=left>
  <tr>
   <td width=168 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=300 height=234 src="p10762.gif" v:shapes="_x0000_s1027"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:"Arial Unicode MS";mso-ansi-language:EN-US;mso-fareast-language:
EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p style='text-align:justify'><span style='font-family:"Times New Roman"'>Your
task is to compute the shortest path that leads from the entrance to the
treasure through the underground corridors. You can switch corridors at grid
points. <o:p></o:p></span></p>

<p style='text-align:justify'><span style='font-family:"Times New Roman"'>The
attached figure illustrates the castle of the first case of sample input. <o:p></o:p></span></p>

<h3><span lang=EN-GB style='font-size:16.0pt;mso-bidi-font-size:13.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-GB'>Input<o:p></o:p></span></h3>

<p style='text-align:justify'><span style='font-family:"Times New Roman"'>The
input file contains multiple cases. The first line of each case contains an
integer number <em>n</em>, 4&nbsp;&#8804;&nbsp;<em>n</em>&nbsp;&#8804;&nbsp;5000,
which is the number of towers in the castle. In each of the next <em>n</em>
lines there are two integers giving the <em>x</em> and <em>y</em> coordinates
of a tower. There is a wall between any two subsequent towers and there is a
wall between the first and the last listed towers. The last two lines of input
give the <em>x and y</em> integer coordinates of the entrance and the treasure,
respectively. </span><span style='font-family:"Times New Roman";mso-fareast-font-family:
"Arial Unicode MS"'><o:p></o:p></span></p>

<p style='text-align:justify'><span style='font-family:"Times New Roman"'>The
input is terminated by a case with <em>n</em>&nbsp;=&nbsp;0 and this case
should not be processed. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-layout-grid-align:none;
text-autospace:none'><span lang=SV><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><span lang=EN-GB style='font-size:16.0pt;mso-bidi-font-size:13.0pt;
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-GB'>Output<o:p></o:p></span></h3>

<h1 style='text-align:justify'><span lang=SV style='font-size:12.0pt;
mso-bidi-font-size:16.0pt;font-family:"Times New Roman";font-weight:normal'>For
each case of input, output one line following the format from the sample
output. The castles are numbered by subsequent integers starting from 1. For each
castle, print its number followed by a colon and after one space print one
integer giving the shortest distance in grid units between the entrance and the
treasure along the underground corridors.</span><span lang=SV style='font-size:
12.0pt;font-family:"Times New Roman";mso-font-kerning:0pt;font-weight:normal'><o:p></o:p></span></h1>

<h1><span lang=SV>Sample Input<span style="mso-spacerun:
yes">                               </span>Output for Sample Input</span><span
lang=SV style='mso-fareast-font-family:"Arial Unicode MS"'><o:p></o:p></span></h1>

<table border=1 cellspacing=0 cellpadding=0 bgcolor="#cccccc" style='background:
 #CCCCCC;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes;mso-yfti-firstrow:yes'>
  <td width=322 valign=top style='width:3.35in;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'><pre><b><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;font-family:"Courier New"'>10<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>9 6<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>9 2<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>12 2<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>12 9<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>2 9<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>2 1<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>8 1<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>8 3<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>4 3<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>4 6<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>11 5<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>3 1<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>5<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>0 0<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>0 1<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>0 2<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>2 2<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>2 0<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>2 2<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>1 1<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>0</span></b></pre>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><span
  lang=SV style='mso-fareast-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=322 valign=top style='width:3.35in;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>Castle 1: 14<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>Castle 2: 2<o:p></o:p></span></b></pre>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b
  style='mso-bidi-font-weight:normal'><span style='font-size:10.0pt;font-family:
  "Courier New";mso-ansi-language:EN-US;mso-fareast-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b
  style='mso-bidi-font-weight:normal'><span lang=SV style='mso-fareast-language:
  ZH-CN'>&nbsp;<o:p></o:p></span></b></p>
  </td>
 </tr>
</table>


<div class=MsoNormal align=center style='text-align:center'><span lang=SV>

<hr size=2 width="100%" align=center>

</span></div>


<p class=MsoCaption><span lang=SV>Problem setter: Krzysztof Diks</span></p>

<p class=MsoNormal><b><span lang=SV style='font-family:Arial'>Adapted by: Piotr
Rudnicki <o:p></o:p></span></b></p>

</div>

</body>

</html>
