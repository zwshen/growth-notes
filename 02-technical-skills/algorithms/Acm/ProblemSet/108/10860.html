<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>Problem E: Many a Little makes a Mickle</title>
<style type="text/css">
<!--
.inout       { font-family: "Courier New", Courier, monospace; font-size: 12pt;  }
.cbfont      { font-size: 13pt; font-family: "Times New Roman", serif; text-align: center }
.psetter     { font-family: Tahoma, sans-serif; font-size: 10pt; font-weight: bold }
.jbfont    	 { font-family: "Times New Roman", serif; font-size: 13pt; text-align:justify }
.bigfont     { font-family: "Times New Roman", serif; font-size: 18pt; font-weight: bold }
.cname 		 { font-family: Arial, sans-serif; font-size: 16pt; font-weight: bold;
					text-align:center; line-height:100%;   }
.pno         { font-family: Arial, sans-serif; font-size: 14pt; font-weight: bold; text-align:center }
.pname       { font-family: Arial, sans-serif; font-size: 24pt; vertical-align: baseline; font-weight: bold; text-align:center }
-->
</style>
</head>

<body>

<table border="2" cellpadding="0" cellspacing="0" width="100%">
	<tr>
		<td>
		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td width="20%" rowspan="3">
				<p class="cbfont">Input: Standard In<br>
				Output: Standard Out</td>
				<!--contest name-->
				<td width="60%" bgcolor="#C0C0C0" class="cname">Next Generation
				Contest 1&nbsp;</td>
				<td width="20%" rowspan="3">
				<p class="cbfont"><b>Time Limit: 2 seconds</b></td>
			</tr>
			<tr>
				<!--problem no-->
				<td width="60%" bgcolor="#C0C0C0" class="pno">Problem &nbsp;E</td>
			</tr>
			<tr>
				<!--problem name-->
				<td width="60%" bgcolor="#C0C0C0" class="pname">Many a Little makes a Mickle</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<p class="jbfont">A long string does not look so long if we can identify a few short substrings that were used (possibly more than once) in some permutation to construct the longer string. Your task is to find if a given (long) string can be made up by choosing some (shorter) strings from a given collection.
</p>
<p class="jbfont">You should note that:
<OL type="a">
<LI>All the strings are composed of ASCII characters in the range 33 to 127.</LI>
<LI>Any of the short strings or their reversed forms can be used any number of times to construct the long string</LI>
<LI>Each use of a short string or its reverse would be counted as one occurance of that short string</LI>
</OL>
</p>
<p class="jbfont">
When you construct the longer string from these short strings you should ensure that it is done by keeping the total occurances of the short strings minimum.
</p>
<p class="jbfont">
For example, if we want to construct the string "aabbabbabbbb" from the set {"a","bb","abb"}, there can be many ways to achieve the goal. "a-abb-abb-abb-bb" and "a-abb-a-bba-bb-bb" are two such valid constructions. However, we would prefer "a-abb-abb-abb-bb" (5 substrings) over "a-abb-a-bba-bb-bb" (6 substrings) because it uses lesser number of substrings. You would only need to find the minimum number of substrings that could be used to construct the given string.
</p>
<p class="bigfont">Input</p>
<p class="jbfont">The first line of the the input contains <b>S (S&lt;51)</b>, the number of data set. Then <b>S</b> number of data set follows. First line of each
data set contains the long string, <b>P (0 &lt; length (P) &lt; 10001)</b>.
The next line contains the number of short strings, <b>N (0 &lt; N &lt; 51)</b> to choose from. Each of the next <b>N</b> lines contain the short string <b>Pi (0 &lt; length (Pi) &lt; 101) [ i &gt;= 1,2,3….N]</b>.
You can safely assume that there is no blank/empty line in the input file.<br>
&nbsp;</p>
<p class="bigfont">Output</p>
<p class="jbfont">For each data set print exactly one line of output.<br>
Either “<b>Set S: C.</b>”<br>
Or “<b>Set S: Not possible.</b>”<br>
If it is possible to construct the string using the given strings then print the first line
otherwise print the second line. Here <b>S</b> is the serial of data set (sequentially from
<b>1</b> to <b>S</b>) and <b>C</b> is the minimum number of times the substrings were used to construct <b>P</b>. For clarification see sample output below.</p>
<p class="bigfont">Sample Input</p>
<table border="1" cellspacing="0" cellpadding="0" width="100%">
	<tr>
		<td class="inout">2<br>
		aabbabbabbbb<br>
		3<br>
		a<br>
		bb<br>
		abb<br>
		ewu**bbacsecsc<br>
		4<br>
		ewu<br>
		bba<br>
		cse<br>
		csc</td>
	</tr>
</table>
<p class="bigfont">Sample Output</p>
<table border="1" cellspacing="0" cellpadding="0" width="100%">
	<tr>
		<td class="inout">Set 1: 5.<br>
		Set 2: Not possible.</td>
	</tr>
</table>
<hr>
<p class="psetter">Problem Setter: A.N.M. Anisur Rahman.<br>
Special thanks to Sohel Hafiz.<br>
Moderated by Monirul Hasan.<br>
</p>

</body>

</html>