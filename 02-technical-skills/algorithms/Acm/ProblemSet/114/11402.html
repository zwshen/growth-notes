<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="Ahoy,%20Pirates_files/filelist.xml">
<link rel=Edit-Time-Data href="Ahoy,%20Pirates_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem D</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PlaceType"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PlaceName"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Mahmudur Rahman</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>mahmud</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>20</o:TotalTime>
  <o:Created>2008-01-16T13:52:00Z</o:Created>
  <o:LastSaved>2008-01-16T13:52:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>555</o:Words>
  <o:Characters>3166</o:Characters>
  <o:Company>EEE, BUET</o:Company>
  <o:Lines>26</o:Lines>
  <o:Paragraphs>7</o:Paragraphs>
  <o:CharactersWithSpaces>3714</o:CharactersWithSpaces>
  <o:Version>10.2625</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:595.45pt 841.7pt;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:24.0pt;font-family:Arial'>Problem H</span></b><span
style='font-size:24.0pt;font-family:Arial'><br>
</span><b><span style='font-size:20.0pt;font-family:Arial'>Ahoy, Pirates!</span></b><b><span
style='font-size:24.0pt;font-family:Arial'><o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;font-family:Arial'>Input: </span></b><span
style='font-size:11.0pt;font-family:Arial;mso-bidi-font-weight:bold'>Standard
Input<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;font-family:Arial'>Output: </span></b><span
style='font-size:11.0pt;font-family:Arial;mso-bidi-font-weight:bold'>Standard
Output <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:11.0pt;
font-family:Arial;mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:11.0pt;
font-family:Arial;mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>In the ancient pirate ages, the <st1:place><st1:PlaceName>Pirate</st1:PlaceName>
 <st1:PlaceType>Land</st1:PlaceType></st1:place> was divided into two teams of
pirates, namely, the Buccaneer and the <st1:place>Barbary</st1:place> pirates.
Each pirate’s team was not fixed, sometimes the opponent pirates attacked and
he was taken away to the other pirate team. All on a sudden a magician appeared
in the <st1:place><st1:PlaceName>Pirate</st1:PlaceName> <st1:PlaceType>Land</st1:PlaceType></st1:place>,
where he was making transition of pirates from their team to other team at his
own will. Of course, handy spells were used. The process of changing team was
known as mutating.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>There were N pirates and all of the pirates have a unique id
from 0 to N-1. The great magician could mutate a bunch of pirates with
consecutive <span class=GramE>id’s</span> to another one.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Suppose there were 100 pirates in the pirate land and all of
them were <st1:place>Barbary</st1:place> pirates, then the magician could cast
a spell to change pirates with <span class=GramE>id’s</span> from 10 to 33 to
Buccaneer pirates. Then the whole pirate land would have 24 Buccaneer and 76 <st1:place>Barbary</st1:place>
pirates.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The magician was very fast casting the spell. Once, God
started to dislike this. God had favor for the Buccaneer pirates and God asked
the magician, “Tell me, how many of the pirates of index from 2 to 30 are
Buccaneer pirates?<span class=GramE>”.</span> Now the magician was puzzled as
he was only efficient in casting spells, not in counting <span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>J</span></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Being clever enough, the magician captured a clever man from
the <st1:place><st1:PlaceName>Earth</st1:PlaceName> <st1:PlaceType>Land</st1:PlaceType></st1:place>.
And unfortunately it’s you! Now you have to answer the God’s questions.</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:11.0pt;
font-family:Arial;mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><b>Input</b></p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The first line of input will contain number of test cases T.</p>

<p class=MsoNormal>For each test case:</p>

<p class=MsoNormal>The first part of the description will be of the pirate
land. There could be up to N (1&lt;=N&lt;=1024000) pirates. Each pirate is
either assigned to Buccaneer or Barbary Pirate. Buccaneer pirates are described
by ‘1’ (ONE) and <st1:place>Barbary</st1:place> pirates are described by ‘0’
(ZERO). You have to build a string of the pirates’ description. Each case
starts with an integer M (M&lt;=100), where M pair lines follow. In each pair
of lines (we call it a set), first has an integer <span class=GramE><b
style='mso-bidi-font-weight:normal'>T<span style='mso-spacerun:yes'>  </span></b>(</span>T
&lt;= 200) and next one has a nonempty string <b style='mso-bidi-font-weight:
normal'>Pirates </b>(consisting of 0 and 1, 0 for <st1:place>Barbary</st1:place>,
1 for Buccaneer, has maximum length of 50). For each pair concatenate the
string <b>Pirates</b>, <b style='mso-bidi-font-weight:normal'>T</b> times.
Concatenate all the resulting M sets of strings to build the pirate
description. The final concatenated string describes the pirates from index 0
to end (N-1 for N pirates).</p>

<p class=MsoNormal>Now the next part of the input will contain queries. First
line of next part has an integer Q describing number of queries. Each
subsequence Q (1&lt;=Q&lt;=1000) lines describe each query. Each query has a
string F or E or I or S and two integers, <span class=GramE>a and</span> b
denoting indexes. The <span class=GramE>meaning of the query string are</span>
follows:</p>

<p class=MsoNormal>F a b, means, mutate the pirates from index <span
class=GramE>a to</span> b to Buccaneer Pirates.</p>

<p class=MsoNormal>E a b, means, mutate the pirates from index <span
class=GramE>a to</span> b to Barbary Pirates.</p>

<p class=MsoNormal>I a b, means, mutate the pirates from index <span
class=GramE>a to</span> b to inverse pirates.</p>

<p class=MsoNormal>S a b, means, “God’s query” God is asking a question: “Tell
me, how many Buccaneer pirates are there from index <span class=GramE>a to</span>
b?”</p>

<p class=MsoNormal style='text-align:justify'>(a &lt;= b, 0 &lt;= a &lt; n, 0
&lt;= b &lt; n, index range are inclusive)</p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'><b>Output<o:p></o:p></b></p>

<p class=MsoNormal>For each test print the case number as the sample output
suggests. Then for each of “God’s query”, output the query number, colon (:)
and a space and the answer to the query as the sample suggest.</p>

<p class=MsoNormal style='text-align:justify'><b><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b>Sample Input<span style='mso-tab-count:5'>                                                  </span>Output
for Sample Input<o:p></o:p></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=590
 style='width:6.15in;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes'>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-family:"Courier New"'>2<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>2<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>5<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>10<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>2<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>1000<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>5<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>F 0 17<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>I 0 5<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>S 1 10<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>E 4 9<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>S 2 10<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>3<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>3<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>1<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>4<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>0<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>2<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>0<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>2<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>I 0 2<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>S 0 8<o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-family:"Courier New"'>Case 1:<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>Q1: 5<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>Q2: 1<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>Case 2:<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'>Q1: 0<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Explanation:</p>

<p class=MsoNormal>Case1:</p>

<p class=MsoNormal>The pirate land is as follows (N = 18)</p>

<p class=MsoNormal>101010101010001000</p>

<p class=MsoNormal>Before God’s first query it was as follows</p>

<p class=MsoNormal>000000111111111111</p>

<p class=MsoNormal><br>
Case 2:</p>

<p class=MsoNormal>The pirate land is as follows (N=9)</p>

<p class=MsoNormal>111000000</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=2 width="100%" align=center>

</div>

<p class=MsoNormal style='text-align:justify'><span class=SpellE>Problemsetter</span>:
<span class=SpellE>Istiaque</span> Ahmed</p>

<p class=MsoNormal>Special Thanks to: Mohammad <span class=SpellE>Mahmudur</span>
<span class=SpellE>Rahman</span><o:p></o:p></p>

</div>

</body>

</html>
