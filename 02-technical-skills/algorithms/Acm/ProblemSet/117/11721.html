<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 10 (filtered)">
<title>Instant View of Big Bang</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
h1
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Arial;}
h2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:Arial;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoBodyText3, li.MsoBodyText3, div.MsoBodyText3
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:28.0pt;
	font-family:Arial;
	font-weight:bold;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.NoSpacingChar, li.NoSpacingChar, div.NoSpacingChar
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman";}
span.NoSpacingCharChar
	{font-family:SimSun;}
p.Style1Char, li.Style1Char, div.Style1Char
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.0pt;
	font-family:"Courier New";
	font-weight:bold;}
span.Style1CharChar
	{font-family:"Courier New";
	font-weight:bold;}
p.Style1, li.Style1, div.Style1
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.0pt;
	font-family:"Courier New";
	font-weight:bold;}
@page Section1
	{size:595.45pt 841.7pt;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=616 colspan=2 style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader align=center style='text-align:center'><b><span
  style='font-size:14.0pt;font-family:Arial;color:purple'>I</span></b><b><span
  style='font-size:14.0pt;font-family:Arial'> <span style='color:#FF6600'>I</span>
  <span style='color:olive'>U</span> <span style='color:red'>P</span> <span
  style='color:#0000B0'>C</span>   <span style='color:#D00000'>2</span> <span
  style='color:#6A00D4'>0</span> <span style='color:#E48800'>0</span> <span
  style='color:#008200'>9</span></span></b></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-size:11.0pt;font-family:Arial'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b><span
  style='font-size:18.0pt;font-family:Arial'>Problem I: Instant View of Big
  Bang</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-size:11.0pt;font-family:Arial'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>Have you forgot about wormholes? Oh my god! Ok, let
  me explain again.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>A wormhole is a subspace tunnel through space and
  time connecting two star systems. Wormholes have a few peculiar properties: </span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>    1. Wormholes are one-way only.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>    2. The time it takes to travel through a
  wormhole is negligible.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>    3. A wormhole has two end points, each situated
  in a star system.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>    4. A star system may have more than one wormhole
  end point within its boundaries.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>    5. Between any pair of star systems, there is at
  most one wormhole in each direction.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>    6. There are no wormholes with both end points
  in the same star system.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>All wormholes have a constant time difference
  between their end points. For example, a specific wormhole may cause the
  person traveling through it to end up 15 years in the future. Another
  wormhole may cause the person to end up 42 years in the past.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>A brilliant physicist, wants to use wormholes to
  study the Big Bang. Since warp drive has not been invented yet, it is not
  possible for her to travel from one star system to another one directly. This
  <em>can</em> be done using wormholes, of course.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>The
  scientist can start her journey from any star system. Then she wants to reach
  a cycle of wormholes somewhere in the universe that causes her to end up in
  the past. By traveling along this cycle a lot of times, the scientist is able
  to go back as far in time as necessary to reach the beginning of the universe
  and see the Big Bang with her own eyes. Write a program to help her to find
  such star systems where she can start her journey.</p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
  style='font-size:14.0pt;font-family:Arial'>Input</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>The first line of the input will contain </span><span
  class=Style1CharChar><span style='font-size:12.0pt'>T,</span></span><span
  style='font-size:12.0pt'> denoting the number of cases.</span></p>
  <p class=NoSpacingChar style='text-align:justify;text-justify:inter-ideograph'><span
  style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Each
  case starts with a blank line. The next line contains two numbers <span
  class=Style1CharChar>n</span> and <span class=Style1CharChar>m</span> . These
  indicate the number of star systems <span class=Style1CharChar>( 1 &#8804; n &#8804;
  1000 )</span> and the number of wormholes <span class=Style1CharChar>( 0 &#8804;
  m &#8804; 2000 )</span>. The star systems are numbered from <span
  class=Style1CharChar>0 </span>through <span class=Style1CharChar>n-1</span> .
  For each wormhole a line containing three integer numbers <span
  class=Style1CharChar>x</span>, <span class=Style1CharChar>y</span> and <span
  class=Style1CharChar>t</span> is given. These numbers indicate that this
  wormhole allows someone to travel from the star system numbered <span
  class=Style1CharChar>x</span> to the star system numbered <span
  class=Style1CharChar>y</span>, thereby ending up <span class=Style1CharChar>t
  ( -1000 &#8804; t &#8804; 1000 ) </span>years in the future or past, a
  negative integer denotes past, positive integer denotes future.</p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
  style='font-size:14.0pt;font-family:Arial'>Output</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>For
  each case, print the case number first, then print the star systems (in
  ascending order) where she can start her journey. If no such star system is
  found, print <span class=Style1CharChar>'impossible'</span>.</p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=309 valign=top style='width:231.85pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
  style='font-size:14.0pt;font-family:Arial'>Sample Input</span></b></p>
  </td>
  <td width=307 valign=top style='width:3.2in;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
  style='font-size:14.0pt;font-family:Arial'>Output for Sample Input</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=309 valign=top style='width:231.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Style1><span style='font-size:12.0pt'>2</span></p>
  <p class=Style1><span style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=Style1><span style='font-size:12.0pt'>3 3</span></p>
  <p class=Style1><span style='font-size:12.0pt'>0 1 1000</span></p>
  <p class=Style1><span style='font-size:12.0pt'>1 2 15</span></p>
  <p class=Style1><span style='font-size:12.0pt'>2 1 -42</span></p>
  <p class=Style1><span style='font-size:12.0pt'>&nbsp;</span></p>
  <p class=Style1><span style='font-size:12.0pt'>4 4</span></p>
  <p class=Style1><span style='font-size:12.0pt'>0 1 10</span></p>
  <p class=Style1><span style='font-size:12.0pt'>1 2 20</span></p>
  <p class=Style1><span style='font-size:12.0pt'>2 3 30</span></p>
  <p class=Style1><span style='font-size:12.0pt'>3 0 -60</span></p>
  </td>
  <td width=307 valign=top style='width:3.2in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
  style='font-family:"Courier New"'>Case 1: 0 1 2</span></b></p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
  style='font-family:"Courier New"'>Case 2: impossible</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;border:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=616 colspan=2 valign=top style='width:462.25pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b>Problem
  Setter: Jane Alam Jan</b></p>
  <p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b>Special
  Thanks: </b><b>Md.</b><b> Abirul Islam</b></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

</div>

</body>

</html>
