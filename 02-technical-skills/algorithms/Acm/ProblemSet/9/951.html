<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<html>
<head>
	<title>The Pieces of the Puzzle</title>
	<style>
	p {text-align: justify;}
	p.center {text-align: center;}
    </style>
</head>

<body bgcolor=white>

<h1 align=center><font color=blue>Problem F - The Pieces of the Puzzle</font></h1>

<p>The children on the playground are now playing with funny
puzzles. They have a number of pieces and they have to make a
pre-determined image. Imagine for example that you have to form the
image depicted in figure 1, only with the available pieces.

<p class=center><img src="p951a.jpg" width="401" height="183" alt="" border="0"><br>
<b>Figure 1 -</b> The image and the pieces of the puzzle

<p>The idea is to use all the pieces to form the image. The pieces can be rotated (by 0, 90, 180 or 260 degrees). Since the pieces
are equal from both sides, they can also be flipped, and also they can be at the same time flipped and rotated. With this rules, one
way to form the image with the pieces would be the one illustrated in figure 2.

<p class=center><img src="p951b.jpg" width="190" height="136" alt="" border="0"><br> 
<b>Figure 2 -</b> Combining the pieces to form the puzzle 

<p>Can you help the children in how to solve every puzzle they have in hands?

<h2><font color=blue>The Problem</font></h2>
<p>Given a set of pieces and an image, you have to discover if it is
possible to combine the pieces in order to form the image. An image is
always a connected set of squares (meaning that there are no
disconnected parts of the image). At the end, there can be no pieces left.
  
<h2><font color=blue>Input</font></h2>
<b>
The input will contain several test cases, each of them as described below.
Consecutive test cases are separated by a single blank line.
</b>
<p>
<p>

<p>The first line of the input will contain two integers <b>H</b> and <b>W</b>, which respectively indicate the height and the width
of the minimal square than can enclose the image to form (<i>1 &le; H,W &le;20</i>). Than come exactly <b><i>H</i></b> lines describing the image itself, each
of these lines exactly with <b><i>W</i></b> chars. A <tt>'#'</tt> means a square that belongs to the image and a <tt>'.'</tt> means
one that does not belong.

<p>After that comes a single line with an integer <b>P</b> indicating the number of pieces available (<i>1 &le; P &le;400</i>), 
followed by <b><i>P</i></b> sets of lines describing the pieces, in a similar way of how the image is described. Each piece starts
by having a single line indicating <b>PH<sub>i</sub></b> and <b>PW<sub>i</sub></b>, the height and width of the minimal square
enclosing the piece (<i>1 &le; <b>PH<sub>i</sub></b>,
<b>PW<sub>i</sub></b> &le; 20</i>), followed by  <i><b>PH<sub>i</sub></b></i> lines with <i><b>PW<sub>i</sub></b></i> chars with the piece, where
<tt>'#'</tt> means a square that belongs to the piece and a <tt>'.'</tt> means
one that does not belong. Note that the pieces can come in any order.

<h2><font color=blue>Output</font></h2>

<p>For each test case, you must output a single line with the word <tt>Yes</tt> if the image can be made with the pieces or <tt>No</tt> if that
is not possible. Remember that all the pieces must be used and that
the pieces can be rotated, flipped or suffer both of these transformations.

<h2><font color=blue>Sample Input</font></h2>
<pre>
5 7
X.X.XXX
X.X.X.X
X.X.XXX
X.X.X..
XXXXX..
7
3 1
X
X
X
3 1
X
X
X
2 1
X
X
1 1
X
3 2
XX
X.
XX
3 2
XX
X.
XX
2 2
X.
XX

3 3
.X.
XXX
.X.
2
2 2
.X
XX
2 1
X
X

3 2
.X
.X
XX
1
3 2
X.
X.
XX
</pre>

<h2><font color=blue>Sample Output</font></h2>
<pre>
Yes
No
Yes
</pre>

</body>

<hr>
<p class=center><b>2005 Programming Contest of Porto University</b><br>
Round 2, 28 of September of 2005<br>
&nbsp;<br>
<i>(Author: <b>Pedro Ribeiro</b> - DCC/FCUP)</i>
<hr>

</html>
