<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Summing The Lengths of Longest Increasing Subsequences of Permutations</TITLE>
</HEAD>
<BODY LANG="EN" BGCOLOR=#FFFFFF>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;
<A NAME="SECTION0001000000000000000000">C. Summing The Lengths of Longest Increasing Subsequences of Permutations</A></FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">The Problem</A></FONT></H2>
<P>Compute the sum of the lengths of the longest increasing subsequence of each distinct permutation of <B>(1,2,3,..,n).</B><p>
In other words, sum over all permutations, <B>w</B> of <B>(1,2,3,..,n)</B>, <B>LIS(w)</B>.  Where <B>LIS(w)</B> is the length of the longest 
increasing subsequence of <B>w</B>.   However, this number increases  exponentially.  In the problem we are interested only 
in the first three digits.  Also, note that each subsequence does not have to be contiguous.  
For example, the longest increasing subsequence of (3,2,4,1,5) is (3,4,5) with length 3.  
<p><B>Hint:</B> You may want to compute a few small values and find a beautiful pattern!!!<p>
<p>

</U></U><H2><FONT COLOR=#0070E8><A NAME="SECTION0001003000000000000000">The Input</A></FONT></H2>
<P>
The input will consist of at most 100000 lines, each one with just the positive integer <B>n</B> (100<<B>n</B><100000000).

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001004000000000000000">The Output</A></FONT></H2>
<P>
For each input value, output the first three digits of the 
sum of the lengths of the longest increasing subsequence of each permuation of (1,2,3,...,<B>n</B>).

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001005000000000000000">Sample Input</A></FONT></H2>
<P>
<PRE>
101
1101
2101
</PRE>
<P>
<H2><FONT COLOR=#0070E8><A NAME="SECTION0001006000000000000000">Sample Output</A></FONT></H2>
<P>
<PRE>
154
358
905
</PRE>
</div>
<br />

<hr size="1" />
Problem setter: Josh Bao<br />
Alternative Solution: Mike Liu
</BODY>
</HTML>
