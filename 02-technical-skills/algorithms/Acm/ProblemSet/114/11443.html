<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="g_files/filelist.xml">
<link rel=Edit-Time-Data href="g_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem G - Tree in a Grid</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Shahriar Manzoor</o:Author>
  <o:LastAuthor>manzoor</o:LastAuthor>
  <o:Revision>126</o:Revision>
  <o:TotalTime>357</o:TotalTime>
  <o:Created>2004-06-18T06:13:00Z</o:Created>
  <o:LastSaved>2008-03-26T12:23:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>311</o:Words>
  <o:Characters>1773</o:Characters>
  <o:Company>ACM/ICPC</o:Company>
  <o:Lines>14</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2080</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129279 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129279 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:Arial;
	font-weight:bold;}
h3
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:16.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	font-weight:bold;}
h5
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:18.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	mso-bidi-font-weight:bold;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
tt
	{font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
p.preformatted, li.preformatted, div.preformatted
	{mso-style-name:preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.StyleArial16pt
	{mso-style-name:"Style Arial 16 pt";
	mso-ansi-font-size:16.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	font-weight:bold;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:28.0pt;mso-bidi-font-size:12.0pt;font-family:
Arial'>Problem G</span></b><span style='font-family:Arial'><br>
</span><b style='mso-bidi-font-weight:normal'><span style='font-size:20.0pt;
mso-bidi-font-size:24.0pt;font-family:Arial'>Tree in a Grid<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'>Input: </span></b><span
style='font-family:Arial;mso-bidi-font-weight:bold'>Standard Input</span><span
style='mso-bidi-font-size:10.0pt;font-family:Arial;color:black;mso-bidi-font-weight:
bold'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'>Output: </span></b><span
style='font-family:Arial;mso-bidi-font-weight:bold'>Standard Output </span><span
style='mso-bidi-font-size:10.0pt;font-family:Arial;color:black;mso-bidi-font-weight:
bold'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>You are given a grid of row r and
column c. The rows are numbered from 0 to r-1 and columns are numbered from 0
to c-1. A node in row <span class=SpellE>i</span> and column j can have edge with
nodes at position (i-1,j),(i,j-1),(i+1,j) and (i,j+1).<span
style='mso-spacerun:yes'>  </span>Now for the given grid some of its edge is
given. You can add some other edge in the grid. You have to add the edges in
such a way so that all the nodes in the grid are connected but do not create
any cycle. You have to count the number of ways that you can add edges in the
grid.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h5 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
class=StyleArial16pt><span style='font-size:16.0pt;mso-bidi-font-size:10.0pt'>Input</span></span><span
class=StyleArial16pt><span style='font-size:16.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"Arial Unicode MS"'><o:p></o:p></span></span></h5>

<p class=MsoNormal style='text-align:justify'>First line contains <span
class=GramE>T(</span>1&#8804;T&#8804;30) the number of test cases. Then T test
cases follow.</p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='text-align:justify'>First line of each test case
contain 3 integer <span class=GramE>r(</span>1&#8804;r&#8804;200),c(1&#8804;c&#8804;8)
and<span style='mso-spacerun:yes'>  </span><span class=SpellE>md</span>(1&#8804;md&#8804;1000000).
Next 2*r-1 line contains the description of the maze. Each of these line
contains 2*c-1 character. Each of the even number column of the even number row
will be a ‘.’ denoting the node. Each of the odd number column of the even
number row will either be a space denoting that there is no edge between the
adjacent vertices or a ‘-‘ character denoting there is an edge. Each of the
even number column of the odd number rows can be single ‘|’ denoting there is a
vertical edge or a single space denoting there is no edge there. See the sample
input for further clarification. Note in the sample input the spaces are
replaced by S for readability. In the original input file they will be spaces.</p>

<h4><span class=StyleArial16pt><span style='font-size:10.0pt;mso-bidi-font-weight:
normal'><o:p>&nbsp;</o:p></span></span></h4>

<h4><span class=StyleArial16pt><span style='mso-bidi-font-weight:normal'>Output
</span></span><span class=StyleArial16pt><span style='font-size:12.0pt;
font-family:"Times New Roman";mso-bidi-font-weight:normal'><o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-align:justify'>For each test case output the
number of ways you can add edges to the grid so that the grid is connected and
form a tree. This result may be large. <span class=GramE>So output <span
class=SpellE>result%md</span>.</span> In the case the existing edges already
creates a cycle output <span class=GramE>A</span> line containing “Impossible”
without the quotes.</p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:Arial;mso-bidi-font-weight:normal;
mso-bidi-font-style:italic'><o:p>&nbsp;</o:p></span></h1>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:16.0pt;mso-bidi-font-size:12.0pt;font-family:Arial;mso-bidi-font-weight:
normal;mso-bidi-font-style:italic'>Sample Input<span
style='mso-spacerun:yes'>                  </span><span
style='mso-spacerun:yes'>           </span>Output for Sample Input</span><span
style='font-size:16.0pt;mso-bidi-font-size:12.0pt;font-family:Arial'><o:p></o:p></span></h1>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='background:#CCCCCC;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=307 valign=top style='width:3.2in;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>6<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>2
  <span class=SpellE>2</span> 1000<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>SSS<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>2
  <span class=SpellE>2</span> 100<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.-.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>|S|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>2
  <span class=SpellE>2</span> 100<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.-.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>|S|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.-.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>3
  <span class=SpellE>3</span> 10000<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>SSSSS<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>SSSSS<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>3
  <span class=SpellE>3</span> 10000<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.-.-.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>SSSSS<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.-.-.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>SSSSS<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.-.-.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>3
  <span class=SpellE>3</span> 10000<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>|S|S|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.S.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>|S|S|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>.S.S.<o:p></o:p></span></p>
  <pre><b><span style='font-size:11.0pt'><o:p>&nbsp;</o:p></span></b></pre></td>
  <td width=309 valign=top style='width:231.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>4<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>1<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>Impossible<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>192<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>9<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:11.0pt;font-family:"Courier New"'>9<o:p></o:p></span></p>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b><span
  style='font-size:11.0pt;font-family:"Courier New";color:black'><o:p>&nbsp;</o:p></span></b></p>
  </td>
 </tr>
</table>

<div class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>

<hr size=2 width="100%" align=center>

</div>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-family:Arial'>Problem-setter: Abdullah al Mahmud<o:p></o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-family:Arial'>Special Thanks: Derek <span class=SpellE>Kisman</span><o:p></o:p></span></b></p>

</div>

</body>

</html>
