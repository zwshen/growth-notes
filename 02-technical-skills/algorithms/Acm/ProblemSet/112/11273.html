<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Warping of N Dimensional Space</TITLE>
</HEAD>
<BODY LANG="EN" BGCOLOR=#FFFFFF>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;
<A NAME="SECTION0001000000000000000000">D. Warping of N Dimensional Space</A></FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">The Problem</A></FONT></H2>

In this problem, we want to apply a linear transformation to warp an <b>N</b> dimensional volume.  
Let <b>Volume(v)</b> denote the volume of the <b>N</b> dimensional parallelepiped 
spanned by <b>N</b>, <b>N</b> dimensional vectors <b>{v<sub>1</sub>,v<sub>2</sub>,...,v<sub>N</sub>}</b>.  
An example of a 2D volume spanned by 2, 2 dimensional vectors is shown below.
In a strange twist, we have decided to apply a "Linear GCD" 
transformation.  That is, if we represent our linear transformation <b>f:R<sup>N</sup>->R<sup>N</sup></b>  
by the matrix <b>A</b>, where <b>R</b> denotes the set of real numbers, then <b>A</b>(i,j) = <b>gcd</b>(i,j) 
for 1 <= i,j <= N, where <b>gcd</b>(i,j) stands for the greatest common divisor of i and j.
Given, <b>S</b>, any set of <b>N</b> vectors of <b>R<sup>N</sup></b>, such that <b>Volume(S)</b> is positive,
we ask you to compute the ratio of the volume after the transformation to the volume 
before the GCD Transformation.  In other words, compute <b>r(S)=Volume(F(S))/Volume(S)</b>,
where <b>F(S)={f(v) | v in S}</b>.
However, since <b>r(S)</b> can be quite large, we only ask you to compute 
<b>T(S)=floor(r(S)) mod  4000039</b>.  In an even stranger twist, we will not give you <b>S</b>,
but instead ask you to compute, the mean value of <b>T(S)</b> over
all <b>N</b> vectors <b>S</b> of <b>R<sup>N</sup></b>, such that  <b>Volume(S)</b> is positive.

<H1 ALIGN=center>
<IMG SRC="p11273.gif" width="600" height="500" border="0">
</H1>

</U></U><H2><FONT COLOR=#0070E8><A NAME="SECTION0001003000000000000000">The Input</A></FONT></H2>
<P>
The input of each test cases is simply the value <b>N</b>(<b>N</b><4000000) on its own line.

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001004000000000000000">The Output</A></FONT></H2>
<P>
For each input value, output the answer rounded to an integer, followed by a newline.

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001005000000000000000">Sample Input</A></FONT></H2>
<P>
<PRE>
10000
10001
</PRE>
<P>
<H2><FONT COLOR=#0070E8><A NAME="SECTION0001006000000000000000">Sample Output</A></FONT></H2>
<P>
<PRE>
2747606
295638
</PRE>
</div>
<br />

<hr size="1" />
Problem setter: Josh Bao<br />
Alternative Solution: Mike Liu
</BODY>
</HTML>
