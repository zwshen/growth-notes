<HTML>
<HEAD>
<TITLE>Diffusing Nuclear Bombs on Planet X</TITLE>
</HEAD>
<BODY LANG="EN" BGCOLOR=#FFFFFF>
 <H1><BR CLEAR=ALL><CENTER><TABLE BGCOLOR=#0060F0><TR><TD><B><FONT SIZE=5 COLOR=#C0FFFF>&nbsp;<A NAME="SECTION0001000000000000000000">J. Diffusing Nuclear Bombs on Planet X</A></FONT>&nbsp;</B></TABLE></CENTER></H1>
<P>

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001002000000000000000">Problem</A></FONT></H2>


<P>
In the year 30823245, a terrorist has planted <b>n</b> nuclear bombs on a planet, which we will refer to as planet X.
You must diffuse all the bombs, by visiting all the bombs and returning to your
starting position in the least amount of time possible.   Planet X is modelled as an ellipsoid with 
axis <b>a</b>,<b>b</b>, and <b>c</b> (i.e., it is defined by the surface 
<b>x</b><sup>2</sup>/<b>a</b><sup>2</sup>+<b>y</b><sup>2</sup>/<b>b</b><sup>2</sup>+<b>z</b><sup>2</sup>/<b>c</b><sup>2</sup>=1).
 The surface consist of both land and bodies of water.  Your traveling
speed on land is different from that of water.  Given your starting position,
the positions of the nuclear bombs, your traveling speed on land and on water, terrain information which
defines which areas are land and which are water, compute the shortest time it takes you to diffuse all bombs and return to 
your headquarter.  All coordinates are given in longitudes, and latitudes in degrees.  The
latitude is measured along the axis of <b>c</b>, while the longitude is measured around the ellipse
formed by axis of <b>a</b> and <b>b</b>.
Use Newtonian physics in this problem (i.e., ignore relativistic effects, even if you travel at or
above the speed of light).
<p>

</U></U><H2><FONT COLOR=#0070E8><A NAME="SECTION0001003000000000000000">The Input</A></FONT></H2>
<P>
There is at most 1001 inputs.
Each input starts with 
<p>
<b>n a b c s_long s_lat w l</b> 
<p>
Under the constraint, <b>n</b> < 15, <b>w</b>+<b>l</b> < 10<sup>10</sup>,  <b>a+b+c</b> < 10<sup>5</sup>.
<p>
on a single line. <b>n</b> is the number of bombs. <b>a,b,c</b> are the axis of the ellipsoid, given in meters with at most 3 digits after the decimal.
<b>s_long,s_lat</b> are the latitude and logitude of the starting position in degrees with at most 3 digits after the decimal.
<b>w</b> is the speed on water, and <b>l</b> is the speed on land in meters per second with at most 3 digits after the decimal.
<p>
<b>n</b> lines follow describing each bomb.  Each line has three floating point numbers, 
<p>
<b>lat long r</b> 
<p>
with at most 3 digits after the dicimal.  <b>lat long</b> are the latitude and logitude of the bomb.  <b>r</b> indicates
that within a geodesic distance of <b>r</b> from the location of the bomb is completely land.  The geodesic
distance is the shortest distance on the surface of the ellipsoid.   Any terrain that is not specified
as land, is considered to be water.

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001004000000000000000">The Output</A></FONT></H2>
<P>
For each input, output the least amount of time in seconds on a single line, rounded to 3 digits after the decimal.

<H2><FONT COLOR=#0070E8><A NAME="SECTION0001005000000000000000">Sample Input</A></FONT></H2>
<P>
<PRE>
3 100.000 100.000 200.000 0.000 0.000 1.0 2.0
20.000 30.000 3.000
40.000 20.000 3.000
10.000 10.000 3.000
</PRE>
<P>
<H2><FONT COLOR=#0070E8><A NAME="SECTION0001006000000000000000">Sample Output</A></FONT></H2>
<P>
<PRE>
367.843
</PRE>
</BODY>
</div>
<br />

<hr size="1" />
Problem setter: Josh Bao
<br />
</HTML>
