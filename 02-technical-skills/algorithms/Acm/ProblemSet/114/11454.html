<html>

<title>Very Well Informed Domino Player</title>


<body bgcolor="#FFFFFF" lang="EN">
<div align="center"><center>

<table border="0" bgcolor="#0060F0">
<TBODY>
  <tr>
    <td><font color="#C0FFFF" size="5"><b>&nbsp;H. Very Well Informed Domino Player&nbsp;</b></font></td>
  </tr>
</TBODY>
</table>
</center></div>


<h2><font color="#0070E8">Context</font></h2>

<p>
Four friends join regularly to play Domino. They are friendly and
always ready to spend the night together playing Domino, but they are
not uninformed by any means.</p>

<p>
One of them, Bob, is specially cautious about the game. He wants to be
so very well informed that he wants to know, given the game (the
pieces of all the players), which piece should he use first to start
the game so that the probability of wining is bigger.</p>

<h2><font color="#0070E8">The Problem</font></h2>

<p>
The Domino game is fairly easy: there are twenty-eight (28) pieces,
each one with two halves. Each half has a number in it, from zero to
six, represented as spots in the surface. You can see pieces as
pairs of numbers. So, the 28 pieces are composed by: (6,6), (6,5),
(6,4), ... (0,0). Pieces can always be seen from both halves, so,
for instance, (6,5) is the same piece as (5,6).</p>

<p>
In the game there are four (4) players. <i>P</i><sub><i>i</i></sub>, with <i>i</i> from 1 to 4.
To start the game, each player has seven (7) pieces,
(<i>p</i><sub><i>ij</i><sub>1</sub></sub>,<i>p</i><sub><i>ij</i><sub>2</sub></sub>), with <i>i</i> from 1 to 4, and <i>j</i> from 1 to 7,
taken at random, and one of them starts the game putting one piece in
the center of the table. Then, all players play in turns putting one
piece into the table (if they have one applicable), by joining it with
the ones that actually are in the table. To build a set of pieces in
the table, the pieces have to "match" by sides. That is, suppose
that in the table there are a set of pieces (<i>x</i><sub>1</sub>,<i>y</i><sub>1</sub>), (<i>x</i><sub>2</sub>,
<i>y</i><sub>2</sub>), (<i>x</i><sub>3</sub>, <i>y</i><sub>3</sub>) ... (<i>x</i><sub><i>n</i></sub>, <i>y</i><sub><i>n</i></sub>). It is always the case
that <i>y</i><sub><i>i</i></sub> = <i>x</i><sub>(<i>i</i>+1)</sub>.  Then, any player can put
another piece (<i>j</i>,<i>k</i>), <b>iff</b> <i>x</i><sub>1</sub>=<i>j</i> <b>or</b> <i>x</i><sub>1</sub>=<i>k</i> <b>or</b> <i>y</i><sub><i>n</i></sub>=<i>k</i>
<b>or</b> <i>y</i><sub><i>n</i></sub>=<i>j</i>. Suppose that the latter, <i>y</i><sub><i>n</i></sub>=<i>j</i> holds. The new set
of pieces on the table would be:</p>


<center> (<i>x</i><sub>1</sub>,<i>y</i><sub>1</sub>), (<i>x</i><sub>2</sub>, <i>y</i><sub>2</sub>), (<i>x</i><sub>3</sub>, <i>y</i><sub>3</sub>) ... (<i>x</i><sub><i>n</i></sub>, <i>y</i><sub><i>n</i></sub>),
  (<i>j</i>, <i>k</i>).
</center>

<p>
Note also that, for the purposes of the game, the pieces in the table
are equivalent if you put them the other way round, that is,


<center>(<i>k</i>, <i>j</i>), (<i>y</i><sub><i>n</i></sub>, <i>x</i><sub><i>n</i></sub>) ... (<i>y</i><sub>3</sub>, <i>x</i><sub>3</sub>), (<i>y</i><sub>2</sub>, <i>x</i><sub>2</sub>),
  (<i>y</i><sub>1</sub>, <i>x</i><sub>1</sub>).
</center></p>

<p>
The game ends when:</p>

<ol type="1">
<li> One player inserts into the table his or her last piece (he or
  she wins).
<div class="p"><!----></div>
</li>

<li> No player can put a new piece. In this case, a sum is computed
  for each player, counting the numeric value of each part of each
  piece the player has left. The winner is the player with less points, that is:

<div class="p"><!----></div>

<br clear="all" /><table border="0" width="95%"><tr><td>
<table align="center" cellspacing="0"  cellpadding="2"><tr><td nowrap="nowrap" align="center">
<i>C</i><sub><i>w</i></sub>&nbsp;&#124;&nbsp;<i>C</i><sub><i>w</i></sub>  &lt;  <i>C</i><sub><i>i</i></sub>,&nbsp;<i>i</i>  &#8712; [1, &#8230;4]</td></tr></table>
</td></tr></table>



<div class="p"><!----></div>
where

<div class="p"><!----></div>

<br clear="all" /><table border="0" width="95%"><tr><td>
<table align="center" cellspacing="0"  cellpadding="2"><tr><td nowrap="nowrap" align="center">
<i>C</i><sub><i>i</i></sub> = </td><td nowrap="nowrap" align="center">
<small></small><!--sup
--><br /><font size="+3">&#8721;<br />
</font><small><i>j</i>  &#8712; <span class="roman">available</span>&nbsp;&nbsp;<span class="roman">pieces</span>&nbsp;&nbsp;<span class="roman">player</span>&nbsp;&nbsp;<span class="roman">i</span></small>&nbsp;<br /></td><td nowrap="nowrap" align="center">
<i>p</i><sub><i>ij</i><sub>1</sub></sub> + <i>p</i><sub><i>ij</i><sub>2</sub></sub></td></tr></table>
</td></tr></table>



<div class="p"><!----></div>
and player <i>w</i> wins. Note that if there are more than one player that
hold the minimum value, there is no winner of this game.
<div class="p"><!----></div>
</li>
</ol>

<p>
At a given point, Bob is informed of all the pieces that the
other players have received. The pieces of each player are these:</p>

<div class="p"><!----></div>
 <b>Bob</b>:

<div class="p"><!----></div>

<center>
<img src="p11454a.png" />
</center>
 <b>Alice</b>:

<div class="p"><!----></div>

<center>
<img src="p11454b.png" />
</center>
 <b>Peter</b>:

<div class="p"><!----></div>

<center>
<img src="p11454c.png" />
</center>
 <b>Mike</b>:

<div class="p"><!----></div>

<center>
<img src="p11454d.png" />
</center>


<p>The first turn goes to Bob, and he wants to know the probability of
wining this game if he starts with any of his pieces... Would you help
him?</p>


<h2><font color="#0070E8">The Input</font></h2>

<p>
The input will be composed of lines. Each line contains the
specification of a piece that Bob has (one of the 7 pieces listed above), composed as follows:</p>

<ul>
<li> A left parenthesis "(",
<div class="p"><!----></div>
</li>

<li> The number of the part, <i>x</i>, (from 0 to 6),
<div class="p"><!----></div>
</li>

<li> a comma ",",
<div class="p"><!----></div>
</li>

<li> The number of the other part, <i>y</i>, (from 0 to 6),
<div class="p"><!----></div>
</li>

<li> A right parenthesis ")".
<div class="p"><!----></div>
</li>
</ul>

<p>
Note that at this point, again, (<i>x</i>,<i>y</i>) is equivalent to (<i>y</i>,<i>x</i>).</p>

<h2><font color="#0070E8">The Output</font></h2>

<p>
For each line of input, the output is another line containing the
following:</p>

<pre>
wins&nbsp;<em>W</em>;&nbsp;loses&nbsp;<em>L</em>
</pre>

<p>
where "<tt><em>W</em></tt>" is the number of all possible
games played starting with that piece where Bob wins; and "<tt><em>L</em></tt>" is the
number of all possible games played starting with that
piece where Bob loses the game.</p>

<h2><font color="#0070E8">Sample Input</font></h2>

<pre>(2,0)
(0,6)
</pre>

<h2><font color="#0070E8">Sample Output</font></h2>

<pre>wins&nbsp;2738632;&nbsp;loses&nbsp;3409819
wins&nbsp;4121220;&nbsp;loses&nbsp;4678487
</pre>
</body>
</html>
