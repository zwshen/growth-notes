<html>

<head>
<meta HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
<title>Sapitaur's Labyrinth</title>
<meta NAME="DESCRIPTION" CONTENT="Sapitaur's Labyrinth">
<meta NAME="resource-type" CONTENT="document">
<meta NAME="autor" CONTENT="GinesGM, dedicated to PablitoGC">
</head>

<body LANG="en" BGCOLOR="#ffffff" DIR="LTR">
<div align="center"><center>

<table BORDER="0" CELLPADDING="2" CELLSPACING="2" BGCOLOR="#0060f0"
STYLE="page-break-before: always">
  <tr>
    <td><font COLOR="#c0ffff">&nbsp;<b><font SIZE="5">Sapitaur's Labyrinth</font></font>&nbsp;</b></td>
  </tr>
</table>
</center></div>

<h2 CLASS="western"><font COLOR="#0070e8">Background</font></h2>

<p>In the distant planet Omicron Persei 8, there is a huge ocean of rotten dark water. In 
the middle of the ocean, there is the island of Nevreturn, where the damned Omicronian 
prisoners are sent. And on the island, there is an intricate labyrinth; only those 
prisoners who are able to escape from the labyrinth are given the merciful death. The 
labyrinth is surrounded by a deep abysm, where the mythical Sapitaur --half frog, half 
bull-- lives, eating all those Omicronians who took a wrong course in the labyrinth. </p>

<p>You are an unfortunate Omicronian prisoner. Will you be able to escape from the 
labyrinth?</p>

<h2 CLASS="western"><font COLOR="#0070e8">The Problem</font></h2>

<p>Sapitaur's Labyrinth consists of a matrix of cells. There are two kinds of cells, as 
shown in the figure below:</p>

<p>- <strong>NOWSE</strong>. There is a wall extending from the North-West of the cell to 
the South-East.</p>

<p>- <strong>NESOW</strong>. There is a wall extending from the North-East of the cell to 
the South-West.</p>

<p ALIGN="CENTER"><img SRC="p11200.png" ALIGN="BOTTOM" WIDTH="720" HEIGHT="179"
BORDER="0"><br>
<em><strong>Left</strong>: the two kinds of cells. <strong>Middle</strong>: a sample 
labyrinth with 3x3 cells, and 2 paths to escape. <strong>Right</strong>: a labyrinth with 
15x10 cells, and only 1 path to escape (in red).</em></p>

<p>As you can see in the figure above, the entrance to the labyrinth is in the north (the 
upper row of the matrix), the exit is in the south (the lower row of the matrix), and the 
abysm extends along both sides of the labyrinth (beyond the first and last column of the 
matrix).</p>

<p>You have to count how many different paths exist to go from the entrance to the exit of 
the labyrinth. Obviously, these paths cannot go through the abysm.</p>

<h2 CLASS="western"><font COLOR="#0070e8">The Input</font></h2>

<p>The first line of the input contains an integer <em>M</em>, indicating the number of 
test cases.</p>

<p>For each test case, the first line contains two integers <em>N</em> <em>M</em>, between 
1 and 500, where <em>N</em> is the width of the labyrinth (number of columns) and <em>M</em> 
is the height (number of rows). <em>M</em> lines follow; each line has <em>N</em> 
characters: &quot;<font FACE="Courier">\</font>&quot;&nbsp; for NOWSE cells; and &quot;<font
FACE="Courier">/</font>&quot;&nbsp; for NESOW cells.</p>

<h2 CLASS="western"><font COLOR="#0070e8">The Output</font></h2>

<p>For each test case, the output should consist of an integer indicating the number of 
different paths from the entrance to the exit of the labyrinth.</p>

<h2 CLASS="western"><font COLOR="#0070e8">Sample Input</font></h2>

<p>Observe that these samples correspond to the labyrinths in the figure above.</p>

<pre>2
3 3
///
\\\
///
15 10
////\\\////\\//
/\\\\\/\/\/\\/\
\\\//\\\/\////\
//\\\/\///\//\\
\/\//\\/\\\\/\\
////////\\///\/
\\\\\\//\\\\\/\
\\/\//////\\///
\/\\/////\/\/\/
\///\///\\\\//\</pre>

<h2 CLASS="western"><font COLOR="#0070e8">Sample Output</font></h2>

<pre>2
1
</pre>
</body>
</html>
