<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>


	<title>Problem F: Heavy Cycle Edges</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head><body>

<h2>Problem F: Heavy Cycle Edges</h2>

<font color="white"><img src="p11747.png" width="400" align="right" border="5"></font>
<p>Given an undirected graph with edge weights, a minimum spanning tree is a subset of edges of
minimum total weight such that any two nodes are connected by some path containing only these edges.
A popular algorithm for finding the minimum spanning tree T in a graph proceeds as follows:
</p><ul><li>let T be initially empty
</li><li>consider the edges e<sub>1</sub>, ..., e<sub>m</sub> in increasing order of weight
<ul><li>add e<sub>i</sub> to T if the endpoints of e<sub>i</sub> are not connected by a path in T
</li></ul></li></ul><p>An alternative algorithm is the following:
</p><ul><li>let T be initially the set of all edges
</li><li>while there is some cycle C in T
<ul><li>remove edge e from T where e has the heaviest weight in C
</li></ul></li></ul><p>Your task is to implement a function related to this algorithm.  Given an undirected graph G with edge weights,
your task is to output all edges that are the heaviest edge in some cycle of G.
</p>
<h3>Input Format</h3>
<p>The first input of each case begins with integers n and m with 1 ≤ n ≤ 1,000 and 0 ≤ m ≤ 25,000
where n is the number of nodes and m is the number of edges in the graph.
Following this are m lines containing three integers u, v, and w describing a weight w edge connecting nodes u and v
where 0 ≤ u, v &lt; n and 0 ≤ w &lt; 2<sup>31</sup>.  Input is 
terminated with a line containing n = m = 0; this case
should not be processed.  You may assume no two edges have the same weight and no two nodes are directly
connected by more than one edge.
</p>
<h3>Output Format</h3>
<p>Output for an input case consists of a single line containing the weights of all edges that are the heaviest edge
in some cycle of the input graph.  These weights should appear in increasing order and consecutive weights should
be separated by a space.  If there are no cycles in the graph then output the text <code>forest</code> instead of numbers.
</p>
<h3>Sample Input</h3>
<pre>3 3
0 1 1
1 2 2
2 0 3
4 5
0 1 1
1 2 2
2 3 3
3 1 4
0 2 0
3 1
0 1 1
0 0
</pre>
<h3>Sample Output</h3>
<pre>3
2 4
forest
</pre>
<hr>
<em>Zachary Friggstad</em>

</body></html>
