<title>H :: Halum</title>
<style type="text/css">
<!--
.style1 {
	font-family: Garamond;
	font-weight: bold;
	font-size: 28px;
	color: #FFFFFF;
}
.style3 {
	font-family: "Courier New", Courier, monospace;
	font-weight: bold;
	font-size:15px
}
.style4 {
	font-family: Georgia, "Times New Roman", Times, serif;
	font-weight: bold;
	font-size: 18px;
	color: #0000FF;
}
.style10 {font-family: "Courier New", Courier, monospace; font-weight: bold; font-size: 13px; }
.style12 {font-family: Garamond; font-weight: bold; font-size: 16px; color: #FFFFFF; }
.style11 {color: #0000FF}
-->
</style>
<body>
<table width="100%" border="0">
  <tr>
    <td width="3%" height="38">&nbsp;</td>
    <td  width="32%" bgcolor="#0000FF"><div align="center" class="style1">Problem H </div></td>
    <td bgcolor="#0000FF" width="30%"><div align="center"><span class="style1">
    Halum</span></div></td>
    <td width="21%" align="center" valign="middle" bgcolor="#0000FF"><div align="center"><span class="style12">Time
    Limit : 3 seconds</span></div></td>
    <td width="12%"><div align="center"></div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="3"><p align="justify"><br>
      You are given a directed graph G(V,E) with a set of vertices  and edges. Each edge (i,j) that connects some vertex i to vertex j has an  integer cost associated with that edge.<br>
&nbsp;<br>
Define the operation Halum(v, d) to operate on a vertex v  using an integer d as follows: subtract d from the cost of all edges that enter  v and add d to the cost of every edge that leaves v.</p>
      <p align="justify">As an example of that operation, consider graph G that has  three vertices named (1, 2, 3) and two edges. Edge (1, 2) has cost -1, and edge  (2,3) has cost 1. The operation Halum(2,-3) operates on edges entering and  leaving vertex 2.&nbsp; Thus, edge (1, 2) gets  cost -1-(-3)=2 and the edge (2, 3) gets cost 1 + (-3) = -2.</p>
      <p align="justify">Your goal is to apply the Halum function to a graph, potentially  repeatedly, until every edge in the graph has at least a certain cost that is  greater than zero. You have to maximize this cost.</p>
      <p>&nbsp;</p>
    </td>
    <td>&nbsp;</td>
  </tr>

  <tr>
    <td>&nbsp;</td>
    <td colspan="2"><span class="style4">Input</span></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="3" align="justify"><p>Two space-separated integers per case: <span class="style10">V(V&le;500)</span> and <span class="style10">E(E&le;2700)</span>. <span class="style10">E</span> lines follow. Each line represents a directed edge using three  space-separated integers (u, v, d). Absolute value of cost can be at most  10000.</p></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="3">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="3"><span class="style4">Output</span></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="3" align="justify"><p>If the problem is solvable, then print the maximum possible  value. If there is no such solution print &ldquo;No Solution&rdquo;. If the value can be  arbitrary large print &ldquo;Infinite&rdquo;</p></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="3">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><span class="style4">Sample Input</span></td>
    <td><span class="style4">Sample Output </span></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>

    <td valign="top"><p class="style10">2 1<br>
      1 2 10<br>
      2 1<br>
      1 2 -10<br>
      3 3<br>
      1 2 4<br>
      2 3 2<br>
      3 1 5<br>
      4 5<br>
      2 3 4<br>
      4 2 5<br>
      3 4 2<br>
      3 1 0<br>
      1 2 -1</p>    <p class="style10"><br>
    </p>
    </td>

    <td valign="top"><p class="style10">Infinite<br>
      Infinite<br>
      3<br>
      1</p>      
      <span class="style10"><br>
      <br />
      </span></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td class="style10" colspan="3"><hr />
      <p>Problem Setter: Md. Mahbubul Hasan<br>
      <span class="style11">Next Generation Contest 5 </span></p>
      </td>
    <td valign="top">&nbsp;</td>
    <td width="1%">&nbsp;</td>
    <td width="1%">&nbsp;</td>
  </tr>
</table>
</body>