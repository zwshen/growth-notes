<html>
<head>
<title>Problem D: Digital Logic</title>
<link rel="stylesheet" href="problem.css">
</head>
<body>

<center>
<h1>Problem D</h1>
<h2>Digital Logic</h2>
</center>

<p>Your task is to design a 4-input 4-output digital circuit, given some 2-input 1-output gates.</p>

<p>Every gate is described by three 0-1 integers <i>Y</i><sub>00</sub>, <i>Y</i><sub>01</sub> and <i>Y</i><sub>11</sub>, the output of the gate when 
there are exactly 0, 1 and 2 of the inputs are set to 1. Note that all the gates are symmetric, so if there is exactly one input 
is set to 1, the output is the same no matter which one is set. Make sure that both inputs of each gate are connected to the 
output of another gate or a signal source, since the output will be unpredictable if at least one input is dangling. 
Be aware that the output of a gate can never go back to its input either directly or indirectly (i.e. the circuit should not 
contain a directed cycle).</p>

<p align="center"><img src="p11211.png" /></p>

<p>To make your design as simple as possible, you should use minimal number of gates. It is guaranteed that the circuit 
could be designed with at most 6 gates.</p>

<h2>Input</h2>
The input consists of at most 30 test cases. Each case contains a single integer <i>n</i> (<i>n</i> < 6), indicating there are <i>n</i> 
kinds of gates. Each of the <i>n</i> lines contained four integers, <i>m<sub>i</sub></i>, <i>Y</i><sub>00</sub>, <i>Y</i><sub>01</sub>, <i>Y</i><sub>11</sub>, 
the number of available gates of this kind, the output values when exactly 0, 1, 2 inputs are set to 1. 
There are at most 10 gates in total (i.e. the sum of <i>m<sub>i</sub></i> will not exceed 10). The next line contains 16 integers 
<i>Y</i><sub>0000</sub>, <i>Y</i><sub>0001</sub>, <i>Y</i><sub>0010</sub>, ..., <i>Y</i><sub>1111</sub>, the output values for each possible 
input combination. <i>Y<sub>prqs</sub></i>'s binary form is the output of the circuit when the four inputs are <i>p</i>, <i>q</i>, <i>r</i>, <i>s</i> respectively. 
That is, if <i>Y<sub>pqrs</sub></i>'s binary form is <i>abcd</i>, then the four outputs are <i>a</i>, <i>b</i>, <i>c</i>, <i>d</i> respectively. 
The last case is followed by a single zero, which should not be processed.

<h2>Output</h2>
For each test case, print the case number and an integer <i>p</i>, the minimal number of gates required. The next <i>p</i> lines each contains four 
integers <i>s</i>, <i>k</i>, <i>a</i> and <i>b</i>, where <i>s</i> is the serial number of the gate (inputs of the entire circuit are numbered 1~4, 
gates are numbered 5~<i>p</i>+4), <i>k</i> is the type number of the gate (gate types are numbered 1~<i>n</i> in the same order as they appeared in the 
input), <i>a</i> and <i>b</i> are serial numbers of two inputs of the gate. It should be satisfied that <i>a</i> < <i>s</i> and <i>b</i> < <i>s</i>. 
The last line should contain four integers: the serial numbers of the gates of four outputs (should be all between 1 and <i>p</i>+4). There should be exactly one empty line after each case. 

<h2>Sample Input</h2>
<pre>
1
5 0 1 0
0 3 6 5 12 15 10 9 8 11 14 13 4 7 2 1
1
2 1 1 0
8 12 10 14 9 13 11 15 8 12 10 14 1 5 3 7
0
</pre>

<h2>Output for the Sample Input</h2>
<pre>
Case 1: 3
5 1 1 2
6 1 2 3
7 1 3 4
5 6 7 4

Case 2: 1
5 1 2 1
5 4 3 2
</pre>

<hr />
<i>Rujia Liu's Present 2: A Big Contest of Brute Force</i><br />
<i>Adapted from Chinese Team Selection Contest for IOI2001, with test data enhanced<br />
</body>
</html>
